!function(t){function e(e){for(var a,s,i=e[0],c=e[1],l=e[2],d=0,m=[];d<i.length;d++)s=i[d],o[s]&&m.push(o[s][0]),o[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);for(u&&u(e);m.length;)m.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},o={0:0},r=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;r.push(["Vtdi",1]),n()}({"+Ajr":function(t,e,n){"use strict";var a=n("20Ks");n.n(a).a},"12/b":function(t,e,n){},"1fcz":function(t,e,n){},"20Ks":function(t,e,n){},"3VuB":function(t,e,n){"use strict";var a=n("FUVo");n.n(a).a},"4WES":function(t,e,n){"use strict";var a=n("5pjf");n.n(a).a},"5Nyv":function(t,e,n){"use strict";var a=n("9bYS");n.n(a).a},"5Ttm":function(t){t.exports={name:"Test",index:"http://127.0.0.1:8887/index.js","menu-items":[{}]}},"5pjf":function(t,e,n){},"9bYS":function(t,e,n){},"9qtH":function(t,e,n){},FUVo:function(t,e,n){},GGsO:function(t,e,n){"use strict";var a=n("TDL8");n.n(a).a},JQmY:function(t,e,n){},Kmra:function(t,e,n){"use strict";var a=n("1fcz");n.n(a).a},Knie:function(t,e,n){},OITN:function(t,e,n){"use strict";var a=n("12/b");n.n(a).a},OTLk:function(t,e,n){},OmPH:function(t,e,n){"use strict";var a=n("OTLk");n.n(a).a},QPUi:function(t,e,n){},RnhZ:function(t,e,n){var a={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function o(t){var e=r(t);return n(e)}function r(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}o.keys=function(){return Object.keys(a)},o.resolve=r,t.exports=o,o.id="RnhZ"},TDL8:function(t,e,n){},"U/FI":function(t,e,n){"use strict";var a=n("QPUi");n.n(a).a},Vtdi:function(t,e,n){"use strict";n.r(e);n("27D/");var a=n("4d7F"),o=n.n(a),r=n("oCYn"),s=n("jE9Z"),i=n("L2JU"),c={name:"Logs",data:function(){return{showDeleteDialog:!1,logIndexToDelete:null}},props:["useGeolocation"],computed:Object(i.b)({logs:function(t){return t.farm.logs},areas:function(t){return t.farm.areas},assets:function(t){return t.farm.assets},currentLogIndex:function(t){return t.farm.currentLogIndex},statusText:function(t){return t.farm.statusText},photoLoc:function(t){return t.farm.photoLoc},geolocation:function(t){return t.farm.geolocation},localArea:function(t){return t.farm.localArea},units:function(t){return t.farm.units},userId:function(t){return t.shell.user.uid},categories:function(t){return t.farm.categories},equipment:function(t){return t.farm.equipment},logDisplayFilters:function(t){return t.shell.settings.logDisplayFilters}}),created:function(){this.$store.dispatch("onLogsComponentCreated"),this.$store.commit("clearDisplayFilters"),this.$store.dispatch("loadCachedDisplayFilters")},beforeDestroy:function(){this.$store.commit("clearLogs")},methods:{openDeleteDialog:function(t){this.showDeleteDialog=!0,this.logIndexToDelete=t},cancelDelete:function(){this.showDeleteDialog=!1},confirmDelete:function(){var t=this.logs[this.logIndexToDelete],e={index:this.logIndexToDelete,local_id:t.local_id,id:t.id,remoteUri:t.remoteUri,name:t.name.data,type:t.type.data};this.$store.commit("deleteLog",e),this.showDeleteDialog=!1,"edit-log"===this.$route.name&&this.$router.push({path:"/logs"})},syncAll:function(){this.$store.dispatch("getLogs")}}},l=(n("4WES"),n("KHd+")),u=Object(l.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("router-view",{attrs:{name:"menubar",logs:t.logs,currentLogIndex:t.currentLogIndex},on:{toggleDrawer:function(e){return t.$emit("toggleDrawer")},deleteCurrentLog:function(e){return t.openDeleteDialog(t.currentLogIndex)},syncAll:t.syncAll}}),t._v(" "),n("router-view",{attrs:{logs:t.logs,areas:t.areas,assets:t.assets,currentLogIndex:t.currentLogIndex,photoLoc:t.photoLoc,geolocation:t.geolocation,localArea:t.localArea,useGeolocation:t.useGeolocation,units:t.units,categories:t.categories,equipment:t.equipment,userId:t.userId,logDisplayFilters:t.logDisplayFilters},on:{deleteLog:function(e){return t.openDeleteDialog(e)}}}),t._v(" "),t.showDeleteDialog?n("div",{staticClass:"modal",attrs:{id:"delete-dialog",tabindex:"-1",role:"dialog"}},[n("div",{staticClass:"modal-filter"}),t._v(" "),n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-header"},[n("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Confirm Deletion")]),t._v(" "),n("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:t.cancelDelete}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),n("div",{staticClass:"modal-body"},[t._v("\n          Are sure you'd like to delete the log \""+t._s(t.logs[t.logIndexToDelete].name.data)+'"? \n          '),t.logs[t.logIndexToDelete].wasPushedToServer?n("span",[t._v("\n            Deleting it on this device will not remove the log from the server.\n          ")]):n("span",[t._v("\n            It has not yet been synced to the server and cannot be recovered after it's deleted.\n          ")])]),t._v(" "),n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.cancelDelete}},[t._v("\n          Cancel\n        ")]),t._v(" "),n("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return t.confirmDelete()}}},[t._v("\n          Delete\n        ")])])])])]):t._e()],1)},[],!1,null,"749cd0aa",null).exports,d=n("wd/R"),m=n.n(d),h=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}})])},[],!1,null,null,null).exports,g=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"}})])},[],!1,null,null,null).exports,p=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm-2 14l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"}})])},[],!1,null,null,null).exports,f=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-6 15h-2v-2h2v2zm0-4h-2V8h2v6zm-1-9c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"}})])},[],!1,null,null,null).exports,v=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM10 17l-3.5-3.5 1.41-1.41L10 14.17 15.18 9l1.41 1.41L10 17z"}})])},[],!1,null,null,null).exports,y=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}})])},[],!1,null,null,null).exports,_=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}}),e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,C={props:["logs","userId","assets","logDisplayFilters","areas"],components:{IconAddCircle:h,IconAssignment:g,IconAssignmentDone:p,IconAssignmentLate:f,IconCloudDone:v,IconCloudUpload:y,IconDelete:_,IconEdit:Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}}),e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,IconSync:Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}}),e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports},beforeRouteLeave:function(t,e,n){"edit-log"===t.name&&"number"==typeof t.params.index?(this.$store.commit("setCurrentLogIndex",t.params.index),n()):"edit-log"===t.name?(this.$store.dispatch("initializeLog",t.params.type),n()):n()},methods:{showDate:function(t){return m.a.unix(t).format("MMM DD YYYY")},mapTidsToAreas:function(t){var e=this;return t.area&&this.areas.length>0?t.area.data.map(function(t){return e.areas.find(function(e){return+e.tid==+t.id})}):[]},mapIdsToAssets:function(t){var e=this;return t.asset&&this.assets.length>0?t.asset.data.map(function(t){return e.assets.find(function(e){return+e.id==+t.id})}):[]},getLogType:function(t){return function(t){switch(t){case"farm_activity":return"Activity";case"farm_harvest":return"Harvest";case"farm_input":return"Input";case"farm_observation":return"Observation";case"farm_seeding":return"Seeding";default:throw new Error("Invalid type")}}(t)},passesFilters:function(t){var e,n,a,o=this;return!(this.logDisplayFilters.excludeTypes.includes(t.type.data)||0===t.log_category.data.length&&o.logDisplayFilters.excludeCategories.includes(-1)||t.log_category.data.some(function(t){return o.logDisplayFilters.excludeCategories.some(function(e){return+e==+t.id})})||(e=o.logDisplayFilters.date,n=new Date,a=void 0,"TODAY"===e&&(n.setDate(n.getDate()-1),a=n.valueOf()/1e3|0),"THIS_WEEK"===e&&(n.setDate(n.getDate()-7),a=n.valueOf()/1e3|0),"THIS_MONTH"===e&&(n.setMonth(n.getMonth()-1),a=n.valueOf()/1e3|0),"THIS_YEAR"===e&&(n.setYear(n.getYear()-1),a=n.valueOf()/1e3|0),"ALL_TIME"===e&&(a=0),!(t.timestamp.data>a)))}}},w=(n("j3JQ"),Object(l.a)(C,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"card-group"},[t.logs.length<1?n("div",{staticClass:"card"},[n("div",{staticClass:"card-body"},[n("h4",{staticClass:"card-title"},[t._v("Let's Get Started!")]),t._v(" "),n("p",{staticClass:"card-text"},[t._v("\n          You don't have any logs to display yet. Logs are records of events\n          in farmOS. You can add some by clicking the "),n("IconAddCircle",{staticClass:"inline-svg"}),t._v("\n          icon below, or you can get uncompleted tasks from the server by\n          clicking the "),n("IconCloudUpload",{staticClass:"inline-svg"}),t._v(" icon above.\n        ")],1)])]):t._e(),t._v(" "),t._l(t.logs,function(e,a){return t.logs.length>0&&t.passesFilters(e)?n("div",{key:"card-"+t.logs.indexOf(e),staticClass:"card"},[n("router-link",{attrs:{to:{name:"edit-log",params:{index:a,type:e.type.data}}}},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"card-row-1"},[e.done.data?n("icon-assignment-done",{staticClass:"assignment done"}):t._e(),t._v(" "),!e.done.data&&1e3*e.timestamp.data>(new Date).valueOf()?n("icon-assignment",{staticClass:"assignment"}):t._e(),t._v(" "),!e.done.data&&1e3*e.timestamp.data<(new Date).valueOf()?n("icon-assignment-late",{staticClass:"assignment late"}):t._e(),t._v(" "),n("div",{staticClass:"log-name"},[n("h5",[t._v(t._s(e.name.data))])]),t._v(" "),e.wasPushedToServer?n("icon-cloud-done",{staticClass:"sync-status"}):e.isReadyToSync?n("div",{staticClass:"spin sync-status",attrs:{"aria-hidden":"true"}},[n("icon-sync")],1):n("icon-cloud-upload",{staticClass:"sync-status"})],1),t._v(" "),n("div",{staticClass:"card-row-2"},[n("p",[t._v(t._s(e.notes.data))])]),t._v(" "),n("div",{staticClass:"card-row-3"},[n("div",{staticClass:"date-and-type"},[n("span",{staticClass:"log-type"},[t._v(t._s(t.getLogType(e.type.data).toUpperCase()))]),t._v(" "),n("span",[t._v(t._s(t.showDate(e.timestamp.data)))])]),t._v(" "),n("div",{staticClass:"tags"},[t._l(t.mapTidsToAreas(e),function(e){return n("span",{staticClass:"tag tag-area"},[t._v("\n                "+t._s(e.name)+"\n              ")])}),t._v(" "),t._l(t.mapIdsToAssets(e),function(e){return n("span",{staticClass:"tag tag-asset"},[t._v("\n                "+t._s(e.name)+"\n              ")])})],2)])])])],1):t._e()})],2),t._v(" "),n("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_observation"}}}},[n("div",{staticClass:"add-circle",on:{click:function(t){}}},[n("div",{staticClass:"background-circle"}),t._v(" "),n("icon-add-circle")],1)])],1)},[],!1,null,"5d5f9f3e",null).exports),b={name:"MenuBar",components:{IconMoreVert:Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}})])},[],!1,null,null,null).exports},props:{more:{type:Boolean,default:!0}},data:function(){return{showMore:!1}},methods:{openMoreMenu:function(t){t.stopPropagation(),this.showMore=!0,document.addEventListener("click",this.handleClickOutside)},handleClickOutside:function(t){var e=document.getElementById("more-menu");null===e||e.contains(t.target)||(this.showMore=!1)}},destroyed:function(){document.removeEventListener("click",this.handleClickOutside)}},L=(n("U/FI"),Object(l.a)(b,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"navbar navbar-light fixed-top"},[n("ul",{staticClass:"left-menu"},[t._t("left-menu")],2),t._v(" "),n("ul",{staticClass:"right-menu"},[t._t("right-menu"),t._v(" "),t.more?n("li",{attrs:{id:"more-trigger"},on:{click:t.openMoreMenu}},[n("icon-more-vert")],1):t._e()],2),t._v(" "),t.showMore?n("ul",{attrs:{id:"more-menu"}},[t._t("more-menu")],2):t._e()])},[],!1,null,"3b110032",null).exports),x=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticStyle:{"enable-background":"new 0 0 512 512"},attrs:{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512",width:"24",height:"24","xml:space":"preserve"}},[e("polygon",{attrs:{points:"222.949,302.964 222.949,512 289.051,467.933 289.051,302.964 \t\t"}}),this._v(" "),e("rect",{attrs:{x:"2.612",width:"506.776",height:"49.576"}}),this._v(" "),e("polygon",{attrs:{points:"19.137,82.627 206.424,269.913 305.576,269.913 492.863,82.627 \t\t"}})])},[],!1,null,null,null).exports,k=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}})])},[],!1,null,null,null).exports,I={name:"AllLogsMenuBar",components:{MenuBar:L,IconCloudUpload:y,IconFilter:x,IconMenu:k}},A=(n("3VuB"),Object(l.a)(I,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("menu-bar",{scopedSlots:t._u([{key:"left-menu",fn:function(){return[n("li",{on:{click:function(e){return t.$emit("toggleDrawer")}}},[n("icon-menu")],1),t._v(" "),n("li",[t._v("My Logs")])]},proxy:!0},{key:"right-menu",fn:function(){return[n("router-link",{staticClass:"filter",attrs:{to:{name:"filter-logs"},tag:"li"}},[n("icon-filter")],1),t._v(" "),n("li",{on:{click:function(e){return t.$emit("syncAll")}}},[n("icon-cloud-upload")],1)]},proxy:!0},{key:"more-menu",fn:function(){return[n("li",{on:{click:function(e){return t.$emit("syncAll")}}},[t._v("Sync all logs")]),t._v(" "),n("router-link",{staticClass:"filter",attrs:{to:{name:"filter-logs"},tag:"li"}},[t._v("\n      Filter logs\n    ")])]},proxy:!0}])})},[],!1,null,"9e35e84e",null).exports),S=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}})])},[],!1,null,null,null).exports,E={name:"EditLogsMenuBar",components:{MenuBar:L,IconArrowBack:S,IconDelete:_,IconOpenInNew:Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),e("path",{attrs:{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"}})])},[],!1,null,null,null).exports},props:["logs","currentLogIndex"]},j=Object(l.a)(E,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("menu-bar",{scopedSlots:t._u([{key:"left-menu",fn:function(){return[n("router-link",{attrs:{to:{name:"logs"},tag:"li"}},[n("icon-arrow-back")],1),t._v(" "),n("li",[t._v("Edit Log")])]},proxy:!0},{key:"right-menu",fn:function(){return[t.logs[t.currentLogIndex]&&t.logs[t.currentLogIndex].remoteUri?n("a",{attrs:{href:t.logs[t.currentLogIndex].remoteUri}},[n("li",[n("icon-open-in-new")],1)]):t._e(),t._v(" "),n("li",{on:{click:function(e){return t.$emit("deleteCurrentLog")}}},[n("icon-delete")],1)]},proxy:!0},{key:"more-menu",fn:function(){return[""!==t.logs[t.currentLogIndex].remoteUri?n("a",{attrs:{href:t.logs[t.currentLogIndex].remoteUri}},[n("li",[t._v("Open in browser")])]):t._e(),t._v(" "),n("li",{on:{click:function(e){return t.$emit("deleteCurrentLog")}}},[t._v("\n      Delete from device\n    ")])]},proxy:!0}])})},[],!1,null,null,null).exports,D=n("YEIV"),T=n.n(D),O=n("gDS+"),M=n.n(O),F={name:"Autocomplete",props:["objects","searchKey","searchId","label"],data:function(){return{search:"",searchResults:[],counter:0,isOpen:!1}},methods:{openResults:function(){this.isOpen=!0},doSearch:function(t){var e=[];if(""!==t)for(var n=t.toLowerCase(),a=0;a<this.objects.length;a+=1){var o=this.objects[a];o.name.toLowerCase().includes(n)&&e.length<10&&e.push(o)}this.searchResults=e,this.search=t},selectSearchResult:function(t){""!==t&&(this.$emit("results",t),this.search="",this.doSearch(this.search))},onArrowDown:function(){this.counter<this.searchResults.length-1&&(this.counter=this.counter+1)},onArrowUp:function(t){t.preventDefault(),this.counter>0&&(this.counter=this.counter-1)},onEnter:function(){var t=this.searchResults[this.counter][this.searchId];this.selectSearchResult(t)},handleClickOutside:function(t){this.$el.contains(t.target)||(this.isOpen=!1,this.arrowCounter=-1)}},mounted:function(){document.addEventListener("click",this.handleClickOutside)},destroyed:function(){document.removeEventListener("click",this.handleClickOutside)}},U=(n("Kmra"),Object(l.a)(F,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-item form-item-name form-group"},[n("label",{staticClass:"control-label",attrs:{for:"search"}},[t._v(t._s(t.label))]),t._v(" "),n("input",{staticClass:"form-control",attrs:{placeholder:"Enter text to search",type:"text"},domProps:{value:t.search},on:{focus:t.openResults,input:function(e){return t.doSearch(e.target.value)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.onArrowDown(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.onArrowUp(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onEnter(e)}]}}),t._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.isOpen&&t.search.length>0,expression:"isOpen && search.length > 0"}],staticClass:"list-group search-results"},[0===t.searchResults.length?n("li",{staticClass:"list-group-item empty"},[t._t("empty",[t._v("No Results")])],2):t._l(t.searchResults,function(e,a){return n("li",{key:"result-"+a+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item",class:{"is-active":a===t.counter},on:{click:function(n){return t.selectSearchResult(e[t.searchId])}}},[t._v("\n      "+t._s(e[t.searchKey])+"\n    ")])})],2)])},[],!1,null,"275bfa6e",null).exports),P=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}}),e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,q=Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}}),e("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,N=(n("mRpm"),Object(l.a)({},function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{staticClass:"spinner",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[e("g",[e("circle",{staticClass:"path",attrs:{cx:"12",cy:"12",r:"10",fill:"none","stroke-width":"3"}})])])},[],!1,null,"40d7c23d",null).exports),$={name:"Map",data:function(){return{map:{},layers:{wkt:null,geojson:null,mapbox:null},defaultStyles:{height:"100vw"}}},props:{id:String,overrideStyles:Object,options:{type:Object,controls:[Boolean,Array,Function],interactions:[Boolean,Array,Function],drawing:Boolean,default:function(){return{controls:!0,interactions:!0,drawing:!1}}},wkt:{title:String,wkt:String,color:String,visible:Boolean},geojson:{title:String,url:String,color:String,visible:Boolean}},computed:Object(i.b)({mapboxAPIKey:function(t){return t.shell.mapboxAPIKey}}),mounted:function(){var t=this;if(this.map=window.farmOS.map.create(this.id,this.options),this.geojson.url&&(this.layers.geojson=this.map.addLayer("geojson",this.geojson)),!this.options.drawing&&this.wkt.wkt&&"GEOMETRYCOLLECTION EMPTY"!==this.wkt.wkt&&(this.layers.wkt=this.map.addLayer("wkt",this.wkt),this.map.zoomToLayer(this.layers.wkt)),!this.geojson.url||this.wkt.wkt&&"GEOMETRYCOLLECTION EMPTY"!==this.wkt.wkt||this.layers.geojson.getSource().once("change",function(){t.map.zoomToVectors()}),this.options.drawing&&this.wkt.wkt&&"GEOMETRYCOLLECTION EMPTY"!==this.wkt.wkt&&(this.map.edit.setWKT(this.wkt.wkt),this.map.zoomToLayer(this.map.edit.layer),this.map.edit.wktOn("drawend",function(e){t.$emit("update-wkt",e)}),this.map.edit.wktOn("modifyend",function(e){t.$emit("update-wkt",e)}),this.map.edit.wktOn("translateend",function(e){t.$emit("update-wkt",e)}),this.map.edit.wktOn("delete",function(e){t.$emit("update-wkt",e)})),this.mapboxAPIKey){var e={title:"MapBox Satellite",url:"https://api.mapbox.com/v4/mapbox.satellite/{z}/{x}/{y}.png?access_token="+this.mapboxAPIKey,group:"Base layers",base:!0,visible:!0};this.layers.mapbox=this.map.addLayer("xyz",e)}},beforeDestroy:function(){window.farmOS.map.destroy(this.id),this.map=null},watch:{wkt:function(t){this.options.drawing?this.map.edit.setWKT(t.wkt):(this.layers.wkt&&(this.map.map.removeLayer(this.layers.wkt),this.layers.wkt=null),this.wkt.wkt&&"GEOMETRYCOLLECTION EMPTY"!==this.wkt.wkt?(this.layers.wkt=this.map.addLayer("wkt",t),this.map.zoomToLayer(this.layers.wkt)):this.map.zoomToVectors())}}},z=Object(l.a)($,function(){var t=this.$createElement;return(this._self._c||t)("div",{style:[this.defaultStyles,this.overrideStyles],attrs:{id:this.id}})},[],!1,null,null,null).exports,R={props:["label","labelPosition","checked"]},G=(n("5Nyv"),Object(l.a)(R,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.label&&"before"===t.labelPosition?n("label",[t._v(t._s(t.label)+" ")]):t._e(),t._v(" "),n("input",{staticClass:"toggle-check",attrs:{type:"checkbox"},domProps:{checked:t.checked},on:{input:function(e){return t.$emit("input",e.target.checked)}}}),t._v(" "),t.label&&"after"===t.labelPosition?n("label",[t._v(t._s(t.label)+" ")]):t._e()])},[],!1,null,"0f9459f7",null).exports),H={props:{id:String,selected:Boolean,label:String,small:Boolean},methods:{checkChecked:function(t){return!document.getElementById(this.id).checked}}},B=(n("rTSf"),Object(l.a)(H,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:t.id,name:t.id},domProps:{checked:t.selected}}),t._v(" "),n("label",{class:[{selected:t.selected},{small:t.small}],attrs:{for:t.id},on:{click:function(e){t.$emit("input",t.checkChecked(t.id))}}},[t._v("\n    "+t._s(t.label)+"\n  ")])])},[],!1,null,"35f02b01",null).exports),Y=n("Mkpm");function V(t,e){return M()(t.coordinates)===M()(e.coordinates)}var Q={name:"EditLog",components:{Autocomplete:U,IconExpandLess:P,IconExpandMore:q,IconSpinner:N,Map:z,ToggleCheck:G,SelectBox:B},data:function(){return{tabSelected:"FIRST",imageUrls:[],attachGeo:!1,useLocalAreas:!1,addedArea:!1,isWorking:!1,showAllCategories:!1,logTypes:{farm_observation:"Observation",farm_activity:"Activity",farm_input:"Input",farm_harvest:"Harvest",farm_seeding:"Seeding"},quantMeasures:["count","length","weight","area","volume","time","temperature","water_content","value","rating","ratio","probability"]}},props:["logs","areas","assets","currentLogIndex","statusText","photoLoc","geolocation","localArea","useGeolocation","units","categories","equipment","type"],beforeMount:function(){this.$router.currentRoute.params.tab&&(this.tabSelected=this.$router.currentRoute.params.tab)},methods:{convertOutOfUnix:function(t){var e=new Date(1e3*t),n=function(t){return t<10?"0"+t:t},a=n(e.getMonth()+1),o=n(e.getDate());return e.getFullYear()+"-"+a+"-"+o},convertIntoUnix:function(t){var e=+t.split("-")[0],n=+t.split("-")[1]-1,a=+t.split("-")[2];return Math.floor(new Date(e,n,a).getTime()/1e3).toString()},forceSync:function(){this.$store.dispatch("forceSyncAssetsAndAreas")},updateCurrentLog:function(t,e){var n,a=(Date.now()/1e3).toFixed(0),o="string"==typeof e?e:M()(e),r=(n={},T()(n,t,{data:o,changed:a}),T()(n,"isCachedLocally",!1),T()(n,"wasPushedToServer",!1),n);this.$store.commit("updateCurrentLog",r)},updateNewQuant:function(t,e){var n=this.logs[this.currentLogIndex].quantity.data.length;if(0===n&&this.addQuant(),"unit"===t){var a={id:e,resource:"taxonomy_term"};this.logs[this.currentLogIndex].quantity.data[n-1][t]=a}else this.logs[this.currentLogIndex].quantity.data[n-1][t]=e;var o={quantity:this.logs[this.currentLogIndex].quantity,isCachedLocally:!1,wasPushedToServer:!1};this.$store.commit("updateCurrentLog",o)},addCategory:function(t){var e={id:t,resource:"taxonomy_term"},n=this.logs[this.currentLogIndex].log_category.data.concat(e);this.updateCurrentLog("log_category",n)},addEquipment:function(t){if(""!==t){var e={id:t,resource:"farm_asset"},n=this.logs[this.currentLogIndex].equipment.data.concat(e);this.updateCurrentLog("equipment",n)}},addAsset:function(t){var e={id:t,resource:"farm_asset"},n=this.logs[this.currentLogIndex].asset.data.concat(e);this.updateCurrentLog("asset",n)},addMovementArea:function(t){var e={id:t,resource:"farm_area"},n=function(t){var e=t.filter(function(t){return""!==t});if(0===e.length)return"";if(1===e.length)return e[0];var n=e.map(Y.parse).reduce(function(t,e){if(!e)return t;if("GeometryCollection"!==e.type)return t.geometries.some(function(t){return V(t,e)})?t:{type:"GeometryCollection",geometries:t.geometries.concat(e)};var n=e.geometries.filter(function(e){return!t.geometries.some(function(t){return V(t,e)})});return{type:"GeometryCollection",geometries:t.geometries.concat(n)}},{type:"GeometryCollection",geometries:[]});return Object(Y.stringify)(n)}([this.areas.find(function(e){return e.tid===t}).geofield[0].geom,this.logs[this.currentLogIndex].movement.data.geometry]),a={area:this.logs[this.currentLogIndex].movement.data.area.concat(e),geometry:n};this.updateCurrentLog("movement",a)},addArea:function(t){if(""!==t){var e={id:t,resource:"farm_area"},n=this.logs[this.currentLogIndex].area.data.concat(e);this.updateCurrentLog("area",n),this.checkAreas()}this.checkAreas()},addQuant:function(){this.logs[this.currentLogIndex].quantity.data.push({measure:"weight",value:0,unit:{id:0,resource:"taxonomy_term"},label:""})},removeAsset:function(t){var e=this.logs[this.currentLogIndex].asset.data.filter(function(e){return e.id!==t.id});this.updateCurrentLog("asset",e)},removeArea:function(t){var e=this.logs[this.currentLogIndex].area.data.filter(function(e){return e.id!==t.tid});this.updateCurrentLog("area",e)},removeMovementArea:function(t){var e=this.logs[this.currentLogIndex].movement.data.area.filter(function(e){return e.id!==t.tid}),n={geometry:function(t,e){if(""===t)return"";if(""===e)return t;var n=Object(Y.parse)(t),a=Object(Y.parse)(e);if("GeometryCollection"!==n.type&&"GeometryCollection"!==a.type)return V(n,a)?"":t;if("GeometryCollection"===n.type&&"GeometryCollection"!==a.type){var o={type:"GeometryCollection",geometries:n.geometries.filter(function(t){return!V(t,a)})};return o.geometries.length>0?Object(Y.stringify)(o):""}if("GeometryCollection"===n.type&&"GeometryCollection"===a.type){var r={type:"GeometryCollection",geometries:n.geometries.filter(function(t){return!a.geometries.some(function(e){return V(t,e)})})};return r.geometries.length>0?Object(Y.stringify)(r):""}if("GeometryCollection"!==n.type&&"GeometryCollection"===a.type)return a.geometries.some(function(t){return V(n,t)})?"":t;throw new Error("Format(s) not recognized as valid WKT.")}(this.logs[this.currentLogIndex].movement.data.geometry,t.geofield[0].geom),area:e};this.updateCurrentLog("movement",n)},removeQuant:function(t){var e=this.logs[this.currentLogIndex].quantity.data;e.splice(t,1),this.updateCurrentLog("quantity",e)},removeCategory:function(t){var e=this.logs[this.currentLogIndex].log_category.data;e.splice(t,1),this.updateCurrentLog("category",e)},removeEquipment:function(t){var e=this.logs[this.currentLogIndex].equipment.data;e.splice(t,1),this.updateCurrentLog("equipment",e)},getPhoto:function(){return this.$store.dispatch("getPhotoLoc")},loadPhoto:function(t){for(var e=0;e<t.length;e+=1)this.imageUrls.push(window.URL.createObjectURL(t[e])),this.$store.dispatch("loadPhotoBlob",t[e])},addLocation:function(){if(void 0===this.geolocation.Longitude&&(this.$store.dispatch("getGeolocation"),this.attachGeo=!0,this.isWorking=!0),void 0!==this.geolocation.Longitude){this.attachGeo=!0;var t=JSON.parse('[{"geom":"POINT ('+this.geolocation.Longitude+" "+this.geolocation.Latitude+')"}]');this.updateCurrentLog("geofield",t)}},checkAreas:function(){var t=this;this.filteredAreas.forEach(function(e){if(void 0!==e.geofield[0]&&void 0!==t.geolocation.Longitude){var n={point:[t.geolocation.Longitude,t.geolocation.Latitude],area:e,radius:.02};t.$store.dispatch("checkInNear",n)}})},getAttached:function(t,e,n){var a=[];return e.forEach(function(e){t.forEach(function(t){e[n]===t.id&&a.push(e)})}),a},assetsRequired:function(){return"farm_seeding"===this.logs[this.currentLogIndex].type.data&&this.selectedAssets<1},showGeofieldData:function(t){var e=this.logs[this.currentLogIndex];return e.geofield&&e.geofield.data.length>0&&!t.geom.includes("POLYGON")}},computed:{filteredAssets:function(){if(this.logs[this.currentLogIndex].asset){var t=this.logs[this.currentLogIndex].asset.data;return this.assets.filter(function(e){return!t.some(function(t){return e.id===t.id})})}return this.assets},filteredAreas:function(){if(this.logs[this.currentLogIndex].area){var t=this.logs[this.currentLogIndex].area.data;return this.areas.filter(function(e){return!t.some(function(t){return e.tid===t.id})})}return this.areas},filteredMovementAreas:function(){if(this.logs[this.currentLogIndex].movement.data.area){var t=this.logs[this.currentLogIndex].movement.data.area;return this.areas.filter(function(e){return!t.some(function(t){return e.tid===t.id})})}return this.areas},selectedAssets:function(){if(this.logs[this.currentLogIndex].asset)return this.getAttached(this.logs[this.currentLogIndex].asset.data,this.assets,"id")},selectedAreas:function(){if(this.logs[this.currentLogIndex].area)return this.getAttached(this.logs[this.currentLogIndex].area.data,this.areas,"tid")},selectedMovementAreas:function(){if(this.logs[this.currentLogIndex].movement.data.area)return this.getAttached(this.logs[this.currentLogIndex].movement.data.area,this.areas,"tid")},quantUnitNames:function(){var t=this;if(this.units.length>0&&this.logs[this.currentLogIndex].quantity.data.length>0){var e=[];return this.logs[this.currentLogIndex].quantity.data.forEach(function(n){n.unit&&t.units.forEach(function(t){parseInt(t.tid,10)===parseInt(n.unit.id,10)&&e.push(t.name)})}),e}return[]},categoryNames:function(){var t=this;if(this.categories.length>0&&this.logs[this.currentLogIndex].log_category.data.length>0){var e=[];return this.logs[this.currentLogIndex].log_category.data.forEach(function(n){t.categories.forEach(function(t){parseInt(t.tid,10)===parseInt(n.id,10)&&e.push(t.name)})}),e}return[]},equipmentNames:function(){var t=this;if(this.equipment.length>0&&this.logs[this.currentLogIndex].equipment&&this.logs[this.currentLogIndex].equipment.data.length>0){var e=[];return this.logs[this.currentLogIndex].equipment.data.forEach(function(n){t.equipment.forEach(function(t){parseInt(t.id,10)===parseInt(n.id,10)&&e.push(t.name)})}),e}return[]},areaGeoJSON:function(){return localStorage.getItem("host")+"/farm/areas/geojson/all"}},watch:{photoLoc:function(){this.updateCurrentLog("images",this.photoLoc)},geolocation:function(){if(this.attachGeo&&void 0!==this.geolocation.Longitude){var t=JSON.parse('[{"geom":"POINT ('+this.geolocation.Longitude+" "+this.geolocation.Latitude+')"}]');this.updateCurrentLog("geofield",t),this.isWorking=!1}this.useLocalAreas&&void 0!==this.geolocation.Longitude&&(this.checkAreas(),this.isWorking=!1)},useLocalAreas:function(){this.useLocalAreas&&(void 0===this.geolocation.Longitude&&(this.$store.commit("clearLocalArea"),this.$store.dispatch("getGeolocation"),this.isWorking=!0),void 0!==this.geolocation.Longitude&&(this.$store.commit("clearLocalArea"),this.checkAreas()))},$route:function(t){"number"==typeof t.params.index?this.$store.commit("setCurrentLogIndex",this.$route.params.index):this.$store.dispatch("initializeLog",this.type)}}},K=(n("GGsO"),Object(l.a)(Q,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-container"},[n("div",{staticClass:"tab-bar"},[n("div",{staticClass:"tab",class:{selected:"FIRST"===t.tabSelected},on:{click:function(e){t.tabSelected="FIRST"}}},[n("h5",[t._v("GENERAL")])]),t._v(" "),n("div",{staticClass:"tab",class:{selected:"SECOND"===t.tabSelected},on:{click:function(e){t.tabSelected="SECOND"}}},[n("h5",[t._v("MOVEMENT")])])]),t._v(" "),n("div",{staticClass:"tab-indicator",class:[{first:"FIRST"===t.tabSelected},{second:"SECOND"===t.tabSelected}]}),t._v(" "),n("div",{staticClass:"container-fluid tab-content first",class:{selected:"FIRST"===t.tabSelected}},[n("br"),t._v(" "),n("div",{staticClass:"form-item form-group"},[n("toggle-check",{attrs:{label:"Done",labelPosition:"after",checked:t.logs[t.currentLogIndex].done.data},on:{input:function(e){return t.updateCurrentLog("done",e)}}})],1),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("label",{staticClass:"control-label",attrs:{for:"name"}},[t._v("Name")]),t._v(" "),n("input",{staticClass:"form-control",attrs:{placeholder:"Enter name",type:"text",autofocus:""},domProps:{value:t.logs[t.currentLogIndex].name.data},on:{input:function(e){return t.updateCurrentLog("name",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("label",{staticClass:"control-label",attrs:{for:"Date"}},[t._v("Date")]),t._v(" "),n("input",{staticClass:"form-control",attrs:{type:"date"},domProps:{value:t.convertOutOfUnix(t.logs[t.currentLogIndex].timestamp.data)},on:{input:function(e){t.updateCurrentLog("timestamp",t.convertIntoUnix(e.target.value))}}})]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("label",{staticClass:"control-label ",attrs:{for:"type"}},[t._v("Log Type")]),t._v(" "),void 0===t.logs[t.currentLogIndex].id?n("div",{staticClass:"input-group"},[n("select",{staticClass:"custom-select col-sm-3 ",domProps:{value:t.logs[t.currentLogIndex].type.data},on:{input:function(e){return t.updateCurrentLog("type",e.target.value)}}},t._l(t.logTypes,function(e,a){return n("option",{key:e+"-"+a,domProps:{value:a}},[t._v("\n              "+t._s(e)+"\n            ")])}),0)]):t._e(),t._v(" "),void 0!==t.logs[t.currentLogIndex].id?n("div",{staticClass:"form-item"},[n("p",[t._v(" "+t._s(t.logTypes[t.logs[t.currentLogIndex].type.data])+" ")])]):t._e()]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("label",{staticClass:"control-label ",attrs:{for:"notes"}},[t._v("Notes")]),t._v(" "),n("textarea",{staticClass:"form-control",attrs:{placeholder:"Enter notes",type:"text"},domProps:{value:t.logs[t.currentLogIndex].notes.data},on:{input:function(e){return t.updateCurrentLog("notes",e.target.value)}}})]),t._v(" "),n("h4",[t._v("Log Categories")]),t._v(" "),n("div",{staticClass:"form-item form-group",attrs:{id:"categories"}},[!t.showAllCategories&&t.logs[t.currentLogIndex].log_category.data.length<1?n("p",[t._v("No categories selected")]):t._e(),t._v(" "),t._l(t.categories,function(e){return t.showAllCategories||t.logs[t.currentLogIndex].log_category.data.some(function(t){return e.tid===t.id})?n("select-box",{key:"category-"+e.tid+"-"+e.name,attrs:{small:"",id:"category-"+e.tid+"-"+e.name,selected:t.logs[t.currentLogIndex].log_category.data.some(function(t){return e.tid===t.id}),label:e.name},on:{input:function(n){n?t.addCategory(e.tid):t.removeCategory(t.logs[t.currentLogIndex].log_category.data.findIndex(function(t){return e.tid===t.id}))}}}):t._e()}),t._v(" "),n("div",{staticClass:"show-hide"},[t.showAllCategories?t._e():n("div",{on:{click:function(e){t.showAllCategories=!t.showAllCategories}}},[n("p",[n("icon-expand-more"),t._v("Show More")],1)]),t._v(" "),t.showAllCategories?n("div",{on:{click:function(e){t.showAllCategories=!t.showAllCategories}}},[n("p",[n("icon-expand-less"),t._v("Show Less")],1)]):t._e()])],2),t._v(" "),n("h4",[t._v("Quantities")]),t._v(" "),n("label",{staticClass:"control-label ",attrs:{for:"quantity"}},[t._v("Add new or edit existing quantity")]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("select",{staticClass:"custom-select col-sm-3 ",attrs:{placeholder:"Quantity measure"},domProps:{value:t.logs[t.currentLogIndex].quantity.data.length>0?t.logs[t.currentLogIndex].quantity.data[t.logs[t.currentLogIndex].quantity.data.length-1].measure:""},on:{input:function(e){return t.updateNewQuant("measure",e.target.value)}}},t._l(t.quantMeasures,function(e){return n("option",{domProps:{value:e}},[t._v("\n            "+t._s(e)+"\n          ")])}),0),t._v(" "),n("input",{staticClass:"form-control",attrs:{placeholder:"Quantity value",type:"number"},domProps:{value:t.logs[t.currentLogIndex].quantity.data.length>0?t.logs[t.currentLogIndex].quantity.data[t.logs[t.currentLogIndex].quantity.data.length-1].value:0},on:{input:function(e){return t.updateNewQuant("value",e.target.value)}}}),t._v(" "),n("select",{staticClass:"custom-select col-sm-3 ",attrs:{placeholder:"Quantity unit"},on:{input:function(e){return t.updateNewQuant("unit",e.target.value)}}},t._l(t.units,function(e){return n("option",{domProps:{value:e.tid}},[t._v("\n            "+t._s(t.units?e.name:"")+"\n          ")])}),0),t._v(" "),n("input",{staticClass:"form-control",attrs:{placeholder:"Quantity label",type:"text"},domProps:{value:t.logs[t.currentLogIndex].quantity.data.length>0?t.logs[t.currentLogIndex].quantity.data[t.logs[t.currentLogIndex].quantity.data.length-1].label:""},on:{input:function(e){return t.updateNewQuant("label",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"form-item form-group"},[t.logs[t.currentLogIndex].quantity.data.length>0?n("ul",{staticClass:"list-group"},t._l(t.logs[t.currentLogIndex].quantity.data,function(e,a){return n("li",{key:"quantity-"+a+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[t._v("\n          "+t._s(e.value)+" "+t._s(t.quantUnitNames.length>0?t.quantUnitNames[a]:"")+" "+t._s(e.label)+"\n          "),n("span",{staticClass:"remove-list-item",on:{click:function(e){return t.removeQuant(a)}}},[t._v("\n            ✕\n          ")])])}),0):t._e()]),t._v(" "),n("div",{staticClass:"form-item form-group"},[n("button",{staticClass:"btn btn-success",attrs:{type:"button",name:"addNewQuantity"},on:{click:t.addQuant}},[t._v("\n        Add another quantity\n      ")])]),t._v(" "),n("h4",[t._v("Assets")]),t._v(" "),n("Autocomplete",{class:{invalid:t.assetsRequired()},attrs:{objects:t.filteredAssets,searchKey:"name",searchId:"id",label:t.assetsRequired()?"Seedings must include assets!":"Add assets to the log"},on:{results:function(e){return t.addAsset(e)}}},[n("template",{slot:"empty"},[n("div",{staticClass:"empty-slot"},[n("em",[t._v("No assets found.")]),t._v(" "),n("br"),t._v(" "),n("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:t.forceSync}},[t._v("\n            Sync Now\n          ")])])])],2),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("ul",{staticClass:"list-group"},t._l(t.selectedAssets,function(e,a){return n("li",{key:"log-"+a+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[t._v("\n          "+t._s(e.name)+"\n          "),n("span",{staticClass:"remove-list-item",on:{click:function(n){return t.removeAsset(e)}}},[t._v("\n            ✕\n          ")])])}),0)]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("label",{staticClass:"control-label ",attrs:{for:"type"}},[t._v("Equipment")]),t._v(" "),n("div",{staticClass:"input-group"},[n("select",{staticClass:"custom-select col-sm-3 ",on:{input:function(e){return t.addEquipment(e.target.value)}}},[n("option",{attrs:{value:""}}),t._v(" "),t._l(t.equipment,function(e){return n("option",{domProps:{value:e.id}},[t._v("\n            "+t._s(e?e.name:"")+"\n          ")])})],2)])]),t._v(" "),n("div",{staticClass:"form-item form-group"},[t.logs[t.currentLogIndex].equipment?n("ul",{staticClass:"list-group"},t._l(t.logs[t.currentLogIndex].equipment.data,function(e,a){return n("li",{key:"log-"+a+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[t._v("\n          "+t._s(t.equipmentNames.length>0?t.equipmentNames[a]:"")+"\n          "),n("span",{staticClass:"remove-list-item",on:{click:function(e){return t.removeEquipment(a)}}},[t._v("\n            ✕\n          ")])])}),0):t._e()]),t._v(" "),"farm_seeding"!==t.logs[t.currentLogIndex].type.data?n("div",{attrs:{id:"areas-and-location"}},[n("h4",[t._v("Areas & Location")]),t._v(" "),t.useGeolocation?n("div",{staticClass:"form-item form-item-name form-group"},[n("div",{staticClass:"form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.useLocalAreas,expression:"useLocalAreas"}],staticClass:"form-check-input",attrs:{type:"radio",id:"dontUseGeo",name:"geoRadioGroup",checked:""},domProps:{value:!1,checked:t._q(t.useLocalAreas,!1)},on:{change:function(e){t.useLocalAreas=!1}}}),t._v(" "),n("label",{staticClass:"form-check-label",attrs:{for:"dontUseGeo"}},[t._v("Search areas")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.useLocalAreas,expression:"useLocalAreas"}],staticClass:"form-check-input",attrs:{type:"radio",id:"doUseGeo",name:"geoRadioGroup"},domProps:{value:!0,checked:t._q(t.useLocalAreas,!0)},on:{change:function(e){t.useLocalAreas=!0}}}),t._v(" "),n("label",{staticClass:"form-check-label",attrs:{for:"doUseGeo"}},[t._v("Use my location")])])]):t._e(),t._v(" "),t.useLocalAreas?n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"areaSelector"}},[t._v("Farm areas near your current location")]),t._v(" "),n("select",{staticClass:"form-control",attrs:{name:"areas"},on:{input:function(e){return t.addArea(e.target.value)}}},[t.localArea.length<1?n("option",{attrs:{value:""}},[t._v("No other areas nearby")]):t._e(),t._v(" "),t.localArea.length>0?n("option",{attrs:{value:"",selected:""}},[t._v("-- Select an Area --")]):t._e(),t._v(" "),t._l(t.localArea,function(e){return t.localArea.length>0?n("option",{key:"area-"+e.tid,domProps:{value:e.tid}},[t._v("\n            "+t._s(e.name)+"\n          ")]):t._e()})],2)]):t._e(),t._v(" "),t.useLocalAreas?t._e():n("Autocomplete",{attrs:{objects:t.filteredAreas,searchKey:"name",searchId:"tid",label:"Add areas to the log"},on:{results:function(e){return t.addArea(e)}}},[n("template",{slot:"empty"},[n("div",{staticClass:"empty-slot"},[n("em",[t._v("No areas found.")]),t._v(" "),n("br"),t._v(" "),n("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:t.forceSync}},[t._v("\n              Sync Now\n            ")])])])],2),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("ul",{staticClass:"list-group"},t._l(t.selectedAreas,function(e,a){return n("li",{key:"log-"+a+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[t._v("\n            "+t._s(e.name)+"\n            "),n("span",{staticClass:"remove-list-item",on:{click:function(n){return t.removeArea(e)}}},[t._v("\n              ✕\n            ")])])}),0)]),t._v(" "),t.useGeolocation?n("div",{staticClass:"form-item form-item-name form-group"},[n("button",{staticClass:"btn btn-success btn-navbar",attrs:{disabled:!1,title:"Add my GPS location to the log",type:"button"},on:{click:t.addLocation}},[t._v("\n          Add my GPS location to the log\n        ")])]):t._e(),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("ul",{staticClass:"list-group"},[t._l(t.logs[t.currentLogIndex].geofield.data,function(e){return t.showGeofieldData(e)?n("li",{staticClass:"list-group-item"},[t._v("\n            "+t._s(e.geom)+"\n            "),n("span",{staticClass:"remove-list-item",on:{click:function(e){return t.updateCurrentLog("geofield",[])}}},[t._v("\n              ✕\n            ")])]):t._e()}),t._v(" "),t.attachGeo&&t.isWorking?n("li",{staticClass:"list-item-group"},[n("icon-spinner")],1):t._e()],2)])],1):t._e(),t._v(" "),n("h4",[t._v("Images")]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("button",{staticClass:"btn btn-info btn-navbar navbar-right",attrs:{disabled:!1,title:"Take picture with camera",type:"button"},on:{click:t.getPhoto}},[t._v("\n        Take picture with camera\n      ")])]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("div",{staticClass:"input-group "},[n("label",{staticClass:"custom-file-label",attrs:{for:"customFile"}},[t._v("\n          Select photo from file\n        ")]),t._v(" "),n("input",{ref:"photo",staticClass:"custom-file-input",attrs:{type:"file"},on:{change:function(e){return t.loadPhoto(e.target.files)}}})])]),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},t._l(t.imageUrls,function(e){return n("img",{key:"preview-"+t.imageUrls.indexOf(e),staticClass:"preview",attrs:{src:e}})}),0)],1),t._v(" "),n("div",{staticClass:"container-fluid tab-content second",class:{selected:"SECOND"===t.tabSelected}},[n("br"),t._v(" "),n("Autocomplete",{class:{invalid:t.assetsRequired()},attrs:{objects:t.filteredAssets,searchKey:"name",searchId:"id",label:t.assetsRequired()?"Seedings must include assets!":"Add assets to be moved"},on:{results:function(e){return t.addAsset(e)}}},[n("template",{slot:"empty"},[n("div",{staticClass:"empty-slot"},[n("em",[t._v("No assets found.")]),t._v(" "),n("br"),t._v(" "),n("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:t.forceSync}},[t._v("\n            Sync Now\n          ")])])])],2),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("ul",{staticClass:"list-group"},t._l(t.selectedAssets,function(e,a){return n("li",{key:"asset-"+a+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[t._v("\n          "+t._s(e.name)+"\n          "),n("span",{staticClass:"remove-list-item",on:{click:function(n){return t.removeAsset(e)}}},[t._v("\n            ✕\n          ")])])}),0)]),t._v(" "),n("Autocomplete",{attrs:{objects:t.filteredMovementAreas,searchKey:"name",searchId:"tid",label:"Movement to"},on:{results:function(e){return t.addMovementArea(e)}}},[n("template",{slot:"empty"},[n("div",{staticClass:"empty-slot"},[n("em",[t._v("No areas found.")]),t._v(" "),n("br"),t._v(" "),n("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:t.forceSync}},[t._v("\n            Sync Now\n          ")])])])],2),t._v(" "),n("div",{staticClass:"form-item form-item-name form-group"},[n("ul",{staticClass:"list-group"},t._l(t.selectedMovementAreas,function(e,a){return n("li",{key:"log-"+a+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[t._v("\n          "+t._s(e.name)+"\n          "),n("span",{staticClass:"remove-list-item",on:{click:function(n){return t.removeMovementArea(e)}}},[t._v("\n            ✕\n          ")])])}),0)]),t._v(" "),n("router-link",{attrs:{to:{name:"edit-map"}}},[n("Map",{attrs:{id:"map",overrideStyles:{height:"90vw"},options:{controls:function(t){return t.filter(function(t){return"Attribution"===t.constructor.name})},interactions:!1},wkt:{title:"movement",wkt:t.logs[t.currentLogIndex].movement.data.geometry,color:"orange"},geojson:{title:"areas",url:t.areaGeoJSON,color:"grey"}}})],1),t._v(" "),n("br")],1)])},[],!1,null,"d7ff3c4a",null).exports),J={name:"EditMapMenuBar",components:{MenuBar:L,IconArrowBack:S},props:["logs","currentLogIndex"],computed:{logLink:function(){return{name:"edit-log",params:{index:this.currentLogIndex,type:this.logs[this.currentLogIndex].type.data,tab:"SECOND"}}}}},W=Object(l.a)(J,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("menu-bar",{attrs:{more:!1},scopedSlots:t._u([{key:"left-menu",fn:function(){return[n("router-link",{attrs:{to:t.logLink,tag:"li"}},[n("icon-arrow-back")],1),t._v(" "),n("li",[t._v("Map")])]},proxy:!0}])})},[],!1,null,null,null).exports,X={name:"EditMap",components:{Map:z},props:["logs","currentLogIndex"],computed:{areaGeoJSON:function(){return localStorage.getItem("host")+"/farm/areas/geojson/all"}},methods:{updateMovement:function(t){var e={movement:{data:{area:this.logs[this.currentLogIndex].movement.data.area,geometry:t},changed:(Date.now()/1e3).toFixed(0)},isCachedLocally:!1,wasPushedToServer:!1};this.$store.commit("updateCurrentLog",e)}}},Z=Object(l.a)(X,function(){var t=this.$createElement;return(this._self._c||t)("Map",{attrs:{id:"map",overrideStyles:{height:"calc(100vh - 3rem)"},options:{controls:function(t){return t.filter(function(t){return"FullScreen"!==t.constructor.name})},drawing:!0},wkt:{title:"movement",wkt:this.logs[this.currentLogIndex].movement.data.geometry,color:"orange"},geojson:{title:"areas",url:this.areaGeoJSON,color:"grey"}},on:{"update-wkt":this.updateMovement}})},[],!1,null,"674cc9c7",null).exports,tt={name:"AllLogsMenuBar",components:{MenuBar:L,IconArrowBack:S},data:function(){return{showMore:!1}},methods:{resetDisplayFilters:function(){this.$store.dispatch("resetDisplayFilters")}}},et=Object(l.a)(tt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("menu-bar",{scopedSlots:t._u([{key:"left-menu",fn:function(){return[n("router-link",{attrs:{to:{name:"logs"},tag:"li"}},[n("icon-arrow-back")],1),t._v(" "),n("li",[t._v("Log Filters")])]},proxy:!0},{key:"more-menu",fn:function(){return[n("li",{on:{click:t.resetDisplayFilters}},[t._v("Reset filters")])]},proxy:!0}])})},[],!1,null,null,null).exports,nt={name:"FilterLogs",props:["categories","logDisplayFilters"],methods:{updateExcludeLogType:function(t,e){e?this.$store.commit("removeFromExcludeTypes",t):this.$store.commit("addToExcludeTypes",t)},updateExcludeLogCategory:function(t,e){e?this.$store.commit("removeFromExcludeCategories",t):this.$store.commit("addToExcludeCategories",t)},setDateFilter:function(t){this.$store.commit("setDateFilter",t)},checkChecked:function(t){return!document.getElementById(t).checked}}},at=(n("OmPH"),Object(l.a)(nt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid"},[n("br"),t._v(" "),n("h4",[t._v("Date")]),t._v(" "),n("div",{staticClass:"form-item form-group"},[n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"radio",name:"date"},domProps:{value:"TODAY",checked:"TODAY"===t.logDisplayFilters.date},on:{input:function(e){return t.setDateFilter(e.target.value)}}}),t._v(" "),n("label",{class:{selected:"TODAY"===t.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(e){return t.setDateFilter("TODAY")}}},[t._v("\n        Today\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"radio",name:"date"},domProps:{value:"THIS_WEEK",checked:"THIS_WEEK"===t.logDisplayFilters.date},on:{input:function(e){return t.setDateFilter(e.target.value)}}}),t._v(" "),n("label",{class:{selected:"THIS_WEEK"===t.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(e){return t.setDateFilter("THIS_WEEK")}}},[t._v("\n        This Week\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"radio",name:"date"},domProps:{value:"THIS_MONTH",checked:"THIS_MONTH"===t.logDisplayFilters.date},on:{input:function(e){return t.setDateFilter(e.target.value)}}}),t._v(" "),n("label",{class:{selected:"THIS_MONTH"===t.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(e){return t.setDateFilter("THIS_MONTH")}}},[t._v("\n        This Month\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"radio",name:"date"},domProps:{value:"THIS_YEAR",checked:"THIS_YEAR"===t.logDisplayFilters.date},on:{input:function(e){return t.setDateFilter(e.target.value)}}}),t._v(" "),n("label",{class:{selected:"THIS_YEAR"===t.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(e){return t.setDateFilter("THIS_YEAR")}}},[t._v("\n        This Year\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"radio",name:"date"},domProps:{value:"ALL_TIME",checked:"ALL_TIME"===t.logDisplayFilters.date},on:{input:function(e){return t.setDateFilter(e.target.value)}}}),t._v(" "),n("label",{class:{selected:"ALL_TIME"===t.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(e){return t.setDateFilter("ALL_TIME")}}},[t._v("\n        All Time\n      ")])])]),t._v(" "),n("h4",[t._v("Log Type")]),t._v(" "),n("div",{staticClass:"form-item form-group"},[n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:"type-farm-activity",name:"log-types"},domProps:{checked:!t.logDisplayFilters.excludeTypes.includes("farm_activity")},on:{input:function(e){return t.updateExcludeLogType("farm_activity",e.target.checked)}}}),t._v(" "),n("label",{class:{selected:!t.logDisplayFilters.excludeTypes.includes("farm_activity")},attrs:{for:"log-types"},on:{click:function(e){t.updateExcludeLogType("farm_activity",t.checkChecked("type-farm-activity"))}}},[t._v("\n        Activity\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:"type-farm-harvest",name:"log-types"},domProps:{checked:!t.logDisplayFilters.excludeTypes.includes("farm_harvest")},on:{input:function(e){return t.updateExcludeLogType("farm_harvest",e.target.checked)}}}),t._v(" "),n("label",{class:{selected:!t.logDisplayFilters.excludeTypes.includes("farm_harvest")},attrs:{for:"log-types"},on:{click:function(e){t.updateExcludeLogType("farm_harvest",t.checkChecked("type-farm-harvest"))}}},[t._v("\n        Harvest\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:"type-farm-input",name:"log-types"},domProps:{checked:!t.logDisplayFilters.excludeTypes.includes("farm_input")},on:{input:function(e){return t.updateExcludeLogType("farm_input",e.target.checked)}}}),t._v(" "),n("label",{class:{selected:!t.logDisplayFilters.excludeTypes.includes("farm_input")},attrs:{for:"log-types"},on:{click:function(e){t.updateExcludeLogType("farm_input",t.checkChecked("type-farm-input"))}}},[t._v("\n        Input\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:"type-farm-observation",name:"log-types"},domProps:{checked:!t.logDisplayFilters.excludeTypes.includes("farm_observation")},on:{input:function(e){return t.updateExcludeLogType("farm_observation",e.target.checked)}}}),t._v(" "),n("label",{class:{selected:!t.logDisplayFilters.excludeTypes.includes("farm_observation")},attrs:{for:"log-types"},on:{click:function(e){t.updateExcludeLogType("farm_observation",t.checkChecked("type-farm-observation"))}}},[t._v("\n        Observation\n      ")])]),t._v(" "),n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:"type-farm-seeding",name:"log-types"},domProps:{checked:!t.logDisplayFilters.excludeTypes.includes("farm_seeding")},on:{input:function(e){return t.updateExcludeLogType("farm_seeding",e.target.checked)}}}),t._v(" "),n("label",{class:{selected:!t.logDisplayFilters.excludeTypes.includes("farm_seeding")},attrs:{for:"log-types"},on:{click:function(e){t.updateExcludeLogType("farm_seeding",t.checkChecked("type-farm-seeding"))}}},[t._v("\n        Seeding\n      ")])])]),t._v(" "),n("h4",[t._v("Log Category")]),t._v(" "),n("div",{staticClass:"form-item form-group"},[n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:"category-none",name:"log-categories"},domProps:{checked:!t.logDisplayFilters.excludeCategories.includes(-1)},on:{input:function(e){return t.updateExcludeLogCategory(-1,e.target.checked)}}}),t._v(" "),n("label",{class:{selected:!t.logDisplayFilters.excludeCategories.includes(-1)},attrs:{for:"log-categories"},on:{click:function(e){t.updateExcludeLogCategory(-1,t.checkChecked("category-none"))}}},[t._v("\n        No Category\n      ")])]),t._v(" "),t._l(t.categories,function(e){return n("div",{staticClass:"form-check"},[n("input",{attrs:{type:"checkbox",id:"category-"+e.tid,name:"log-categories"},domProps:{checked:!t.logDisplayFilters.excludeCategories.includes(e.tid)},on:{input:function(n){return t.updateExcludeLogCategory(e.tid,n.target.checked)}}}),t._v(" "),n("label",{class:{selected:!t.logDisplayFilters.excludeCategories.includes(e.tid)},attrs:{for:"log-categories"},on:{click:function(n){t.updateExcludeLogCategory(e.tid,t.checkChecked("category-"+e.tid))}}},[t._v("\n        "+t._s(e.name)+"\n      ")])])})],2)])},[],!1,null,"b60fe192",null).exports);r.a.use(s.a);var ot=new s.a({routes:[{path:"/",redirect:"/logs"},{path:"/logs",component:u,children:[{path:"",name:"logs",components:{default:w,menubar:A}},{path:"edit/:type",name:"edit-log",components:{default:K,menubar:j},props:{default:!0,menubar:!0},children:[]},{path:"map",name:"edit-map",components:{default:Z,menubar:W},props:{default:!0,menubar:!0}},{path:"filter",name:"filter-logs",components:{default:at,menubar:et}}]}]}),rt=n("QbLZ"),st=n.n(rt),it=n("GQeE"),ct=n.n(it),lt=n("EJiy"),ut=n.n(lt),dt="FARMOS_SERVER",mt="VUEX_STORE",ht=(Date.now()/1e3).toFixed(0);function gt(t){if("object"===(void 0===t?"undefined":ut()(t))){var e=[];return Array.isArray(t)?t.forEach(function(t){"string"==typeof t?e.push(t):ct()(t).forEach(function(n){t[n].id?e.push(""+t[n].id):e.push(t[n])})}):ct()(t).forEach(function(n){e.push(t[n])}),e}if("string"==typeof t)return""===t?[]:[].concat(t);throw new Error(t+" cannot be parsed as an image array")}function pt(t){if("object"===(void 0===t?"undefined":ut()(t)))return t;if("string"==typeof t)return JSON.parse(t);throw new Error(t+" cannot be parsed as an object array")}function ft(t){return Array.isArray(t)?t.map(function(t){return"d"===t.charAt(0)?t:{fid:t}}):t}function vt(t){return void 0!==t.value&&""!==t.value&&null!==t.value?t.value.slice(3,-5):""}var yt=function(t,e){if(t===mt||void 0===t)return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.log_owner,a=void 0===n?{changed:null,data:""}:n,o=t.quantity,r=void 0===o?{changed:null,data:[]}:o,s=t.log_category,i=void 0===s?{changed:null,data:[]}:s,c=t.equipment,l=void 0===c?{changed:null,data:[]}:c,u=t.id,d=t.local_id,m=t.name,h=void 0===m?{changed:null,data:""}:m,g=t.type,p=void 0===g?{changed:null,data:""}:g,f=t.timestamp,v=void 0===f?{changed:null,data:""}:f,y=t.images,_=void 0===y?{changed:null,data:[]}:y,C=t.done,w=void 0===C?{changed:null,data:!0}:C,b=t.isCachedLocally,L=void 0!==b&&b,x=t.isReadyToSync,k=void 0!==x&&x,I=t.wasPushedToServer,A=void 0!==I&&I,S=t.remoteUri,E=void 0===S?"":S,j=t.asset,D=void 0===j?{changed:null,data:[]}:j,T=t.area,O=void 0===T?{changed:null,data:[]}:T,M=t.geofield,F=void 0===M?{changed:null,data:[]}:M,U=t.notes,P=void 0===U?{changed:null,data:""}:U,q=t.movement,N=void 0===q?{changed:null,data:{area:[],geometry:""}}:q,$=void 0;return e!==mt&&void 0!==e||($={log_owner:a,notes:P,quantity:{data:pt(r.data),changed:r.changed},log_category:{data:pt(i.data),changed:i.changed},equipment:{data:pt(l.data),changed:l.changed},id:u,local_id:d,name:h,type:p,timestamp:v,images:{data:gt(_.data),changed:_.changed},done:{data:JSON.parse(w.data),changed:w.changed},isCachedLocally:JSON.parse(L),isReadyToSync:JSON.parse(k),wasPushedToServer:JSON.parse(A),remoteUri:E,asset:{data:pt(D.data),changed:D.changed},movement:{data:pt(N.data),changed:N.changed}},"farm_seeding"!==p.data&&O&&($.area={data:pt(O.data),changed:O.changed}),"farm_seeding"!==p.data&&F&&($.geofield={data:pt(F.data),changed:F.changed})),e===dt&&($={notes:{format:"farm_format",value:P.data},name:h.data,done:w.data?1:0,type:p.data,timestamp:v.data,images:ft(_.data),asset:D.data,quantity:r.data,log_category:i.data,equipment:l.data,movement:N.data},u&&($.id=u),"farm_seeding"!==p.data&&O&&($.area=O.data),"farm_seeding"!==p.data&&F&&($.geofield=F.data)),"INDEXEDDB"===e&&($={log_owner:a,notes:P,quantity:r,log_category:i,equipment:l,id:u,name:h,type:p,timestamp:v,images:_,done:w,wasPushedToServer:A,remoteUri:E,asset:D,movement:N},d&&($.local_id=d),"farm_seeding"!==p.data&&O&&($.area=O),"farm_seeding"!==p.data&&F&&($.geofield=F)),$};if(t===dt)return function(t){var e=t.log_owner,n=t.quantity,a=t.log_category,o=t.equipment,r=t.id,s=t.local_id,i=t.name,c=t.type,l=t.timestamp,u=t.images,d=t.done,m=t.url,h=t.asset,g=t.area,p=t.geofield,f=t.notes,v=t.movement,y={log_owner:{data:e,changed:ht},notes:{data:vt(f),changed:ht},quantity:{data:n,changed:ht},log_category:{data:a,changed:ht},equipment:{data:o,changed:ht},local_id:s,name:{data:i,changed:ht},type:{data:c,changed:ht},timestamp:{data:l,changed:ht},images:{data:u,changed:ht},done:{data:d,changed:ht},isCachedLocally:!1,wasPushedToServer:!0,remoteUri:m,asset:{data:h,changed:ht},movement:{data:v,changed:ht}};return"farm_seeding"!==c&&g&&(y.area={data:g,changed:ht}),"farm_seeding"!==c&&p&&(y.geofield={data:p,changed:ht}),r&&(y.id=r),y};throw new Error("Incorrect parameters passed to makeLog")},_t={create:yt(),toStore:yt(mt,mt),toIdb:yt(mt,"INDEXEDDB"),toServer:yt(mt,dt),fromServer:yt(dt,mt)},Ct=n("WVt+"),wt={actions:{getGeolocation:function(t){var e=t.commit,n={};navigator.geolocation.getCurrentPosition(function(t){n.Latitude=t.coords.latitude,n.Longitude=t.coords.longitude,n.Altitude=t.coords.altitude,n.Accuracy=t.coords.accuracy,n.AltitudeAccuracy=t.coords.altitudeAccuracy,n.Heading=t.coords.heading,n.Speed=t.coords.speed,n.Timestamp=t.timestamp,e("setGeoloc",n)},function(t){})},checkInNear:function(t,e){var n=t.commit;function a(t){var e=t.split(", "),n=[];return e.forEach(function(t){var e=t.split(" ");n.push([Number(e[0]),Number(e[1])])}),n}var o=function(t){var e=[];return t.includes("GEOMETRY")?t.slice(30,-3).split(")), POLYGON ((").forEach(function(t){e.push(a(t))}):e.push(a(t.slice(10,-2))),e}(e.area.geofield[0].geom),r=Ct.circle(e.point,e.radius,{units:"kilometers"}),s=Ct.polygon(o),i=Ct.inside(e.point,s),c=null!==Ct.intersect(r,s);(i||c)&&n("addLocalArea",e.area)}}};r.a.use(i.a);var bt={state:{errors:[],user:{name:"",email:"",uid:null,isLoggedIn:!1},mapboxAPIKey:"",settings:{useGeolocation:!0,logImportFilters:{log_owner:null,done:"0",type:["farm_activity","farm_observation","farm_harvest","farm_input","farm_seeding"]},logDisplayFilters:{date:"ALL_TIME",excludeTypes:[],excludeCategories:[]}}},mutations:{logError:function(t,e){t.errors=t.errors.concat([e])},dismissError:function(t,e){var n=st()({},t.errors[e],{show:!1});t.errors.splice(e,1,n)},changeUsername:function(t,e){t.user.name=e},changeEmail:function(t,e){t.user.email=e},changeUid:function(t,e){t.user.uid=e,t.settings.logImportFilters.log_owner=e},changeMapboxAPIKey:function(t,e){t.mapboxAPIKey=e},setLoginStatus:function(t,e){t.user.isLoggedIn=e},setUseGeolocation:function(t,e){t.settings.useGeolocation=e},addToExcludeTypes:function(t,e){var n=t.settings.logDisplayFilters.excludeTypes.concat(e);t.settings.logDisplayFilters.excludeTypes=n,localStorage.setItem("excludeTypes",M()(n))},removeFromExcludeTypes:function(t,e){var n=t.settings.logDisplayFilters.excludeTypes.filter(function(t){return e!==t});t.settings.logDisplayFilters.excludeTypes=n,localStorage.setItem("excludeTypes",M()(n))},addToExcludeCategories:function(t,e){var n=t.settings.logDisplayFilters.excludeCategories.concat(e);t.settings.logDisplayFilters.excludeCategories=n,localStorage.setItem("excludeCategories",M()(n))},removeFromExcludeCategories:function(t,e){var n=t.settings.logDisplayFilters.excludeCategories.filter(function(t){return e!==t});t.settings.logDisplayFilters.excludeCategories=n,localStorage.setItem("excludeCategories",M()(n))},setDateFilter:function(t,e){t.settings.logDisplayFilters.date=e,localStorage.setItem("dateFilter",e)},clearDisplayFilters:function(t){t.settings.logDisplayFilters={date:"ALL_TIME",excludeTypes:[],excludeCategories:[]}}},actions:{loadCachedDisplayFilters:function(t){var e=t.commit,n=JSON.parse(localStorage.getItem("excludeTypes")),a=JSON.parse(localStorage.getItem("excludeCategories")),o=localStorage.getItem("dateFilter");null!==n&&n.forEach(function(t){return e("addToExcludeTypes",t)}),null!==a&&a.forEach(function(t){return e("addToExcludeCategories",t)}),null!==o&&e("setDateFilter",o)},resetDisplayFilters:function(t){(0,t.commit)("clearDisplayFilters"),localStorage.setItem("excludeTypes","[]"),localStorage.setItem("excludeCategories","[]"),localStorage.setItem("dateFilter","ALL_TIME")}}},Lt={state:{name:"",url:"",logs:[],assets:[],areas:[],currentLogIndex:0,photoLoc:"",geolocation:{},localArea:[],units:[],categories:[],equipment:[]},mutations:{changeFarmName:function(t,e){t.name=e},changeFarmUrl:function(t,e){t.url=e},addLogs:function(t,e){t.logs=t.logs.concat(e)},addAssets:function(t,e){t.assets=t.assets.concat(e)},addAreas:function(t,e){t.areas=t.areas.concat(e)},addUnits:function(t,e){t.units=t.units.concat(e)},addCategories:function(t,e){t.categories=t.categories.concat(e)},addEquipment:function(t,e){t.equipment=t.equipment.concat(e)},updateUnitsFromCache:function(t,e){t.units=t.units.concat(e)},updateCategoriesFromCache:function(t,e){t.categories=t.categories.concat(e)},updateEquipmentFromCache:function(t,e){t.equipment=t.equipment.concat(e)},addLogAndMakeCurrent:function(t,e){t.currentLogIndex=t.logs.push(e)-1},addLogFromServer:function(t,e){var n=t.logs.push(e)-1;this.dispatch("serverLogToDb",{index:n,log:e})},setCurrentLogIndex:function(t,e){t.currentLogIndex=e},updateCurrentLog:function(t,e){var n=_t.create(st()({},t.logs[t.currentLogIndex],e));t.logs.splice(t.currentLogIndex,1,n)},updateLogFromServer:function(t,e){t.logs.splice(e.index,1,e.log)},updateAllLogs:function(t,e){t.logs=t.logs.map(function(t){return e(t)})},updateLogs:function(t,e){e.indices.map(function(n){return t.logs.splice(n,1,e.mapper(t.logs[n]))})},updateAsset:function(t,e){var n=t.assets.findIndex(function(t){return t.id===e.id});t.assets.splice(n,1,e)},updateArea:function(t,e){var n=t.areas.findIndex(function(t){return t.id===e.id});t.areas.splice(n,1,e)},deleteLog:function(t,e){var n=e.index;t.logs.splice(n,1)},deleteAllAssets:function(t){t.assets=[]},deleteAllAreas:function(t){t.areas=[]},deleteAllUnits:function(t){t.units=[]},deleteAllCategories:function(t){t.categories=[]},deleteAllEquipment:function(t){t.equipment=[]},clearLogs:function(t){t.logs.splice(0,t.logs.length)},clearAssets:function(t){t.assets.splice(0,t.assets.length)},clearAreas:function(t){t.areas.splice(0,t.areas.length)},clearUnits:function(t){t.units.splice(0,t.units.length)},clearCategories:function(t){t.categories.splice(0,t.categories.length)},clearEquipment:function(t){t.equipment.splice(0,t.equipment.length)},setPhotoLoc:function(t,e){t.photoLoc=e},setGeoloc:function(t,e){t.geolocation=e},addLocalArea:function(t,e){t.localArea.push(e)},clearLocalArea:function(t){t.localArea=[]}},actions:{initializeLog:function(t,e){var n=t.commit,a=new Date,o=Math.floor(a/1e3).toString(),r=a.toLocaleTimeString("en-US"),s=a.toLocaleDateString("en-US");n("addLogAndMakeCurrent",_t.create({type:{data:e,changed:o},name:{data:s+" - "+r,changed:o},timestamp:{data:o,changed:o}}))},forceSyncAssetsAndAreas:function(){},getLogs:function(){},serverLogToDb:function(){},onLogsComponentCreated:function(){}}},xt=new i.a.Store({modules:{shell:bt,farm:Lt,geo:wt}}),kt=n("kiQV"),It={name:"App",components:{IconMenu:k,IconArrowBack:S},data:function(){return{showDrawer:!1,version:kt.a}},computed:Object(i.b)({errors:function(t){return t.shell.errors},username:function(t){return t.shell.user.name},isLoggedIn:function(t){return t.shell.user.isLoggedIn},useGeolocation:function(t){return t.shell.settings.useGeolocation},farmName:function(t){return t.farm.name},farmUrl:function(t){return""===t.farm.url?"example.farmos.net":t.farm.url}}),watch:{showDrawer:function(t){t?document.querySelector("body").setAttribute("style","overflow-y: hidden"):document.querySelector("body").setAttribute("style","overflow-y: visible")}},methods:{closeError:function(t){this.$store.commit("dismissError",t)},setUseGeolocation:function(t){this.$store.commit("setUseGeolocation",t)}}},At=(n("hZfW"),Object(l.a)(It,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"html",attrs:{id:"app"}},[n("transition",{attrs:{name:"filter"}},[t.showDrawer?n("div",{staticClass:"modal-filter",on:{click:function(e){t.showDrawer=!t.showDrawer}}}):t._e()]),t._v(" "),n("transition",{attrs:{name:"drawer"}},[t.showDrawer?n("div",{staticClass:"drawer container-fluid"},[n("header",{staticClass:"drawer-header row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"arrow-back",on:{click:function(e){t.showDrawer=!t.showDrawer}}},[n("icon-arrow-back")],1),t._v(" "),t.isLoggedIn?n("div",{staticClass:"user-info"},[n("h2",[t._v(t._s(t.farmName))]),t._v(" "),n("p",[t._v(t._s(t.farmUrl.replace(/(^\w+:|^)\/\//,"")))]),t._v(" "),n("p",[t._v(t._s(t.username))])]):n("div",{staticClass:"user-info"},[n("h2",[t._v("Welcome to farmOS")]),t._v(" "),n("p",[t._v("Login for more options.")])])])]),t._v(" "),n("ul",{staticClass:"row list-group",on:{click:function(e){t.showDrawer=!t.showDrawer}}},[n("router-link",{attrs:{to:{name:"logs"}}},[n("li",{staticClass:"list-group-item"},[t._v("My Logs")])]),t._v(" "),n("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_activity"}}}},[n("li",{staticClass:"list-group-item"},[t._v("New Activity")])]),t._v(" "),n("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_harvest"}}}},[n("li",{staticClass:"list-group-item"},[t._v("New Harvest")])]),t._v(" "),n("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_input"}}}},[n("li",{staticClass:"list-group-item"},[t._v("New Input")])]),t._v(" "),n("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_observation"}}}},[n("li",{staticClass:"list-group-item"},[t._v("New Observation")])]),t._v(" "),n("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_seeding"}}}},[n("li",{staticClass:"list-group-item"},[t._v("New Seeding")])])],1),t._v(" "),n("ul",{staticClass:"row list-group"},[n("li",{staticClass:"list-group-item"},[n("label",{attrs:{for:"location-switch"}},[t._v("Share My Location ")]),t._v(" "),n("input",{staticClass:"toggle-check",attrs:{id:"location-switch",type:"checkbox"},domProps:{checked:t.useGeolocation},on:{input:function(e){return t.setUseGeolocation(e.target.checked)}}})]),t._v(" "),n("li",{staticClass:"list-group-item"},[t._v("Version: "+t._s(t.version))]),t._v(" "),t.isLoggedIn?t._e():n("router-link",{attrs:{to:"/login"}},[n("li",{staticClass:"list-group-item",on:{click:function(e){t.showDrawer=!t.showDrawer}}},[t._v("Login")])]),t._v(" "),t.isLoggedIn?n("router-link",{attrs:{to:"/logout"}},[n("li",{staticClass:"list-group-item",on:{click:function(e){t.showDrawer=!t.showDrawer}}},[t._v("Logout")])]):t._e()],1)]):t._e()]),t._v(" "),n("main",[n("section",[t._l(t.errors,function(e,a){return n("div",{key:"err-"+t.errors.indexOf(e)},[e.show?n("div",{staticClass:"alert alert-warning alert-dismissable"},[n("span",{domProps:{innerHTML:t._s(e.message)}}),t._v(" "),n("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){return t.closeError(a)}}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]):t._e()])}),t._v(" "),n("div",{staticClass:"region region-content"},[n("div",{staticClass:"block block-system"},[n("router-view",{attrs:{useGeolocation:t.useGeolocation},on:{toggleDrawer:function(e){t.showDrawer=!t.showDrawer}}})],1)])],2)])],1)},[],!1,null,"509f5282",null).exports),St=(n("qQ/H"),n("oGNR"),n("5Ttm"));r.a.config.productionTip=!1;var Et=function(){return o.a.resolve({client:{modules:[St]}})},jt={actions:{getPhotoLoc:function(t){var e=t.commit,n=t.rootState;new o.a(function(t,e){var n={quality:50,destinationType:Camera.DestinationType.DATA_URL};navigator.camera.getPicture(function(e){t(e)},function(t){e(t)},n)}).then(function(t){var a=n.farm.logs[n.farm.currentLogIndex],o="data:image/jpeg;base64,"+t,r=(Date.now()/1e3).toFixed(0),s={images:{data:a.images.data.concat(o),changed:r},isCachedLocally:!1,wasPushedToServer:!1};e("updateCurrentLog",s)},function(t){})},loadPhotoBlob:function(t,e){var n=t.commit,a=t.rootState,r=a.farm.logs[a.farm.currentLogIndex],s=(Date.now()/1e3).toFixed(0);(function(t){return new o.a(function(e,n){var a=new FileReader;a.onloadend=function(){return e(a.result)},a.onerror=function(){return n(a.error)},a.readAsDataURL(t)})})(e).then(function(t){var e={images:{data:r.images.data.concat(t),changed:s},isCachedLocally:!1,wasPushedToServer:!1};n("updateCurrentLog",e)})}}};var Dt={install:function(t,e){e.store.registerModule("camera",jt)}},Tt=n("sk9p"),Ot={version:1,name:"farmos",stores:[{name:"logs",keyPath:"local_id",autoIncrement:!0},{name:"assets",keyPath:"id",autoIncrement:!1},{name:"areas",keyPath:"tid",autoIncrement:!1},{name:"units",keyPath:"tid",autoIncrement:!1},{name:"categories",keyPath:"tid",autoIncrement:!1},{name:"equipment",keyPath:"id",autoIncrement:!1}]};function Mt(){return new o.a(function(t,e){var n=indexedDB.open(Ot.name,Ot.version);n.onerror=function(t){return e(t.target.errorcode)},n.onsuccess=function(){return t(n.result)},n.onupgradeneeded=function(t){var e=t.currentTarget.result;Ot.stores.forEach(function(t){var n=t.name,a=t.keyPath,o=t.autoIncrement;e.createObjectStore(n,{keyPath:a,autoIncrement:o})})}})}function Ft(t,e){return new o.a(function(n,a){var o=t.transaction(e,"readonly").objectStore(e).getAll();o.onerror=function(t){return a(t.target)},o.onsuccess=function(t){return n(t.target.result)}})}function Ut(t,e,n){return new o.a(function(a,o){var r=t.transaction(e,"readwrite").objectStore(e).put(n);r.onerror=function(t){return o(new Error(t.target.errorcode))},r.onsuccess=function(t){return a(t.target.result)}})}function Pt(t,e){return new o.a(function(n,a){var o=t.transaction(e,"readwrite").objectStore(e).clear();o.onsuccess=function(t){return n(t.target.result)},o.onerror=function(t){return a(t.error)}})}var qt=n.n(Tt)()(Ot.stores,6),Nt=qt[0],$t=qt[1],zt=qt[2],Rt=qt[3],Gt=qt[4],Ht=qt[5],Bt={actions:{createCachedLog:function(t,e){var n=t.commit,a=_t.toIdb(e);Mt().then(function(t){return Ut(t,Nt.name,a)}).then(function(t){return n("updateCurrentLog",{local_id:t,isCachedLocally:!0})})},createLogFromServer:function(t,e){var n=t.commit,a=e.index,o=e.log,r=_t.toIdb(o);Mt().then(function(t){return Ut(t,Nt.name,r)}).then(function(t){n("updateLogFromServer",{index:a,log:_t.create(st()({},o,{local_id:t,isCachedLocally:!0}))})})},loadCachedLogs:function(t){var e=t.commit;Mt().then(function(t){return Ft(t,Nt.name)}).then(function(t){var n=t.map(function(t){return _t.create(st()({},t,{isCachedLocally:!0}))});e("addLogs",n)}).catch(console.error)},updateCachedLog:function(t,e){var n=t.commit,a=t.rootState,o=_t.toIdb(st()({},a.farm.logs[a.farm.currentLogIndex],e));Mt().then(function(t){return Ut(t,Nt.name,o)}).then(function(t){return n("updateCurrentLog",{isCachedLocally:!0,local_id:t})})},updateCachedLogAtIndex:function(t,e){var n=t.commit,a=t.rootState,o=e.log,r=e.index,s=_t.toIdb(st()({},a.farm.logs[r],o));Mt().then(function(t){return Ut(t,Nt.name,s)}).then(function(t){return n("updateLogFromServer",{index:r,log:_t.create(st()({},o,{isCachedLocally:!0,local_id:t}))})})},deleteCachedLog:function(t,e){var n=e.local_id;Mt().then(function(t){return function(t,e,n){return new o.a(function(a,o){var r=t.transaction(e,"readwrite").objectStore(e).delete(n);r.onsuccess=function(t){return a(t.target.result)},r.onerror=function(t){return o(t.error)}})}(t,Nt.name,n)}).catch(console.error)},deleteAllCachedLogs:function(){Mt().then(function(t){return Pt(t,Nt.name)}).catch(console.error)},createCachedAsset:function(t,e){Mt().then(function(t){return Ut(t,$t.name,e)}).catch(console.error)},updateCachedAsset:function(t,e){Mt().then(function(t){return Ut(t,$t.name,e)}).catch(console.error)},deleteAllCachedAssets:function(){Mt().then(function(t){return Pt(t,$t.name)}).catch(console.error)},loadCachedAssets:function(t){var e=t.commit;Mt().then(function(t){return Ft(t,$t.name)}).then(function(t){e("addAssets",t)}).catch(console.error)},createCachedArea:function(t,e){Mt().then(function(t){return Ut(t,zt.name,e)}).catch(console.error)},updateCachedArea:function(t,e){Mt().then(function(t){return Ut(t,zt.name,e)}).catch(console.error)},deleteAllCachedAreas:function(){Mt().then(function(t){return Pt(t,zt.name)}).catch(console.error)},loadCachedAreas:function(t){var e=t.commit;Mt().then(function(t){return Ft(t,zt.name)}).then(function(t){e("addAreas",t)}).catch(console.error)},createCachedUnit:function(t,e){Mt().then(function(t){return Ut(t,Rt.name,e)}).catch(console.error)},updateCachedUnit:function(t,e){Mt().then(function(t){return Ut(t,Rt.name,e)}).catch(console.error)},deleteAllCachedUnits:function(){Mt().then(function(t){return Pt(t,Rt.name)}).catch(console.error)},loadCachedUnits:function(t){var e=t.commit;Mt().then(function(t){return Ft(t,Rt.name)}).then(function(t){e("updateUnitsFromCache",t)}).catch(console.error)},createCachedCategory:function(t,e){Mt().then(function(t){return Ut(t,Gt.name,e)}).catch(console.error)},updateCachedCategory:function(t,e){Mt().then(function(t){return Ut(t,Gt.name,e)}).catch(console.error)},deleteAllCachedCategories:function(){Mt().then(function(t){return Pt(t,Gt.name)}).catch(console.error)},loadCachedCategories:function(t){var e=t.commit;Mt().then(function(t){return Ft(t,Gt.name)}).then(function(t){e("updateCategoriesFromCache",t)}).catch(console.error)},createCachedEquipment:function(t,e){Mt().then(function(t){return Ut(t,Ht.name,e)}).catch(console.error)},updateCachedEquipment:function(t,e){Mt().then(function(t){return Ut(t,Ht.name,e)}).catch(console.error)},deleteAllCachedEquipment:function(){Mt().then(function(t){return Pt(t,Ht.name)}).catch(console.error)},loadCachedEquipment:function(t){var e=t.commit;Mt().then(function(t){return Ft(t,Ht.name)}).then(function(t){e("addEquipment",t)}).catch(console.error)}}},Yt={install:function(t,e){var n=e.store;n.registerModule("idb",Bt),n.subscribeAction(function(t){"onLogsComponentCreated"===t.type&&(n.dispatch("loadCachedUserAndSiteInfo"),n.dispatch("updateUserAndSiteInfo"),n.commit("clearLogs"),n.commit("clearAssets"),n.commit("clearAreas"),n.commit("clearUnits"),n.commit("clearCategories"),n.commit("clearEquipment"),n.dispatch("loadCachedLogs"),n.dispatch("loadCachedAssets"),n.dispatch("loadCachedAreas"),n.dispatch("loadCachedUnits"),n.dispatch("loadCachedCategories"),n.dispatch("loadCachedEquipment"))}),n.subscribe(function(t){"addLogAndMakeCurrent"===t.type&&n.dispatch("createCachedLog",t.payload),"updateCurrentLog"!==t.type||JSON.parse(t.payload.isCachedLocally)||n.dispatch("updateCachedLog",t.payload),"updateLogFromServer"!==t.type||JSON.parse(t.payload.log.isCachedLocally)||n.dispatch("updateCachedLogAtIndex",t.payload),"updateLogs"===t.type&&t.payload.indices.forEach(function(t){n.dispatch("updateCachedLog",n.state.farm.logs[t])}),"deleteLog"===t.type&&n.dispatch("deleteCachedLog",t.payload),"addAssets"===t.type&&t.payload.forEach(function(t){n.dispatch("createCachedAsset",t)}),"updateAsset"===t.type&&n.dispatch("updateCachedAsset",t.payload),"deleteAllAssets"===t.type&&n.dispatch("deleteAllCachedAssets"),"addAreas"===t.type&&t.payload.forEach(function(t){n.dispatch("createCachedArea",t)}),"updateArea"===t.type&&n.dispatch("updateCachedArea",t.payload),"deleteAllAreas"===t.type&&n.dispatch("deleteAllCachedAreas"),"addUnits"===t.type&&t.payload.forEach(function(t){n.dispatch("createCachedUnit",t)}),"deleteAllUnits"===t.type&&n.dispatch("deleteAllCachedUnits"),"addCategories"===t.type&&t.payload.forEach(function(t){n.dispatch("createCachedCategory",t)}),"deleteAllCategories"===t.type&&n.dispatch("deleteAllCachedCategories"),"addEquipment"===t.type&&t.payload.forEach(function(t){n.dispatch("createCachedEquipment",t)}),"deleteAllEquipment"===t.type&&n.dispatch("deleteAllCachedEquipment"),"setUseGeolocation"===t.type&&localStorage.setItem("useGeolocation",t.payload)})}},Vt=n("Yz+Y"),Qt=n.n(Vt),Kt=n("iCc5"),Jt=n.n(Kt),Wt=n("FYw3"),Xt=n.n(Wt),Zt=n("mRg0"),te=n.n(Zt),ee=n("vzJi"),ne=n.n(ee),ae=function(){var t=localStorage.getItem("host"),e=localStorage.getItem("username"),n=localStorage.getItem("password");return ne()(t,e,n)},oe=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.indices,o=void 0===a?[]:a,r=n.http;Jt()(this,e);for(var s=arguments.length,i=Array(s>1?s-1:0),c=1;c<s;c++)i[c-1]=arguments[c];var l=Xt()(this,(t=e.__proto__||Qt()(e)).call.apply(t,[this].concat(i)));return l.name="SyncError",l.indices=o,l.http=r,l}return te()(e,t),e}(Error),re={actions:{updateAreas:function(t){var e=t.commit;return ae().area.get().then(function(t){e("deleteAllAreas");var n=t.list.map(function(t){return{tid:t.tid,name:t.name,geofield:t.geofield}});e("addAreas",n)})},updateAssets:function(t){var e=t.commit;return ae().asset.get().then(function(t){e("deleteAllAssets");var n=t.list.map(function(t){return{id:t.id,name:t.name,type:t.type}});e("addAssets",n)})},updateUnits:function(t){var e=t.commit;return ae().term.get("farm_quantity_units").then(function(t){e("deleteAllUnits");var n=t.list.map(function(t){return{tid:t.tid,name:t.name}});e("addUnits",n)})},updateCategories:function(t){var e=t.commit;return ae().term.get("farm_log_categories").then(function(t){e("deleteAllCategories");var n=t.list.map(function(t){return{tid:t.tid,name:t.name}});e("addCategories",n)})},updateEquipment:function(t){var e=t.commit;return ae().asset.get().then(function(t){e("deleteAllEquipment");var n=function(t){var e=[];return t.forEach(function(t){"equipment"===t.type&&e.push(t)}),e}(t.list.map(function(t){return{id:t.id,name:t.name,type:t.type}}));e("addEquipment",n)})},sendLogs:function(t,e){var n=t.commit,a=t.rootState;e.forEach(function(t){var e=_t.toServer(a.farm.logs[t]);ae().log.send(e,localStorage.getItem("token")).then(function(e){return function(t,e){n("updateLogs",{indices:[e],mapper:function(e){return _t.create(st()({},e,{id:t.id,wasPushedToServer:!0,isReadyToSync:!1,remoteUri:t.uri}))}})}(e,t)}).catch(function(e){throw new oe({indices:[t],http:e})})})},getServerLogs:function(t){var e=t.commit,n=t.rootState,a=localStorage.getItem("syncDate"),o=n.farm.logs;return ae().log.get(n.shell.settings.logImportFilters).then(function(t){return t.list.map(function(t){var n=se(t,o,a);if(n.serverChange){var r=ie(t,n,a);e("updateLogFromServer",{index:n.storeIndex,log:r})}if(null===n.localId){var s=ie(t,n,a);e("addLogFromServer",s)}return t.id})}).then(function(t){var e=o.filter(function(e){return e.id&&!t.some(function(t){return e.id===t})}).map(function(t){return t.id});return ae().log.get(e)}).then(function(t){t.list.forEach(function(t){var n=se(t,o,a);if(n.serverChange){var r=ie(t,n,a);e("updateLogFromServer",{index:n.storeIndex,log:r})}})}).catch(function(t){throw new oe({http:t})})},unreadyLog:function(t,e){(0,t.commit)("updateLogs",{indices:[e],mapper:function(t){return _t.create(st()({},t,{isReadyToSync:!1}))}})}}};function se(t,e,n){var a={localId:null,storeIndex:null,localChange:!0,serverChange:!1,log:null};return e.forEach(function(e,o){e.id&&e.id===t.id&&(a.localId=e.local_id,a.storeIndex=o,!0===JSON.parse(e.wasPushedToServer)?a.localChange=!1:a.log=e,+t.changed>+n&&(a.serverChange=!0))}),a}function ie(t,e,n){if(null===e.localId)return _t.fromServer(st()({},t,{wasPushedToServer:!0,isReadyToSync:!1,done:1===parseInt(t.done,10)}));if(!e.localChange&&e.serverChange)return _t.fromServer(st()({},t,{wasPushedToServer:!0,isReadyToSync:!1,local_id:e.localId,done:1===parseInt(t.done,10)}));var a=e.log,o={},r={},s=_t.fromServer(t);return ct()(a).forEach(function(t){a[t].changed&&null!==a[t].changed&&(+a[t].changed<+n?o[t]=s[t]:r[t]=a[t])}),_t.toStore(st()({},r,o,{wasPushedToServer:!1,local_id:e.localId,id:t.id,done:{changed:Math.floor(Date.now()/1e3),data:1==+t.done},isReadyToSync:!0}))}var ce,le,ue={install:function(t,e){var n=e.store,a=e.router;function o(t,e,a){return void 0!==e.isReadyToSync&&JSON.parse(e.isReadyToSync)&&!JSON.parse(e.wasPushedToServer)&&function(t,e){var a={message:"",level:"warning",show:!0};if("farm_seeding"===t.type.data){var o=n.state.farm.assets,r=[];if(t.asset.data.forEach(function(t){o.forEach(function(e){e.id===t.id&&"planting"===e.type&&r.push(e.id)})}),r.length<1)return a.message="Could not sync "+t.name.data+" because seeding logs must have at least one planting asset.",n.commit("logError",a),n.dispatch("unreadyLog",e),!1}return!0}(e,a)?t.concat(a):t}function r(t){n.commit("updateAllLogs",function(t){return st()({},t,{isReadyToSync:!1})});var e=t.indices.length>0?t.indices.reduce(function(t,e){return t+', "'+n.state.farm.logs[e]+'"'},""):"";if(void 0===t.http.response){var o={message:"Unable to sync "+e+" because the network is currently unavailable. Please try syncing again later.",level:"warning",show:!0};n.commit("logError",o)}else if(401===t.http.response.status||403===t.http.response.status||404===t.http.response.status)a.push("/login");else{var r={message:t.http.response.status+' error while syncing "'+e+'": '+t.http.response.statusText,errorCode:t.http.response.statusText,level:"warning",show:!0};n.commit("logError",r)}}n.registerModule("http",re),n.subscribeAction({after:function(t){if("forceSyncAssetsAndAreas"===t.type){if(null!==localStorage.getItem("host"))return n.dispatch("updateAssets"),void n.dispatch("updateAreas");a.push("/login")}"getLogs"===t.type&&(localStorage.getItem("token")?(n.commit("updateAllLogs",function(t){return st()({},t,{isReadyToSync:!0})}),n.dispatch("getServerLogs").then(function(){localStorage.setItem("syncDate",(Date.now()/1e3).toFixed(0));var t=n.state.farm.logs.reduce(o,[]);n.dispatch("sendLogs",t)}).catch(r)):a.push("/login")),"serverLogToDb"===t.type&&n.dispatch("createLogFromServer",t.payload),"loadCachedAssets"===t.type&&n.dispatch("updateAssets"),"loadCachedAreas"===t.type&&n.dispatch("updateAreas"),"sendLogs"===t.type&&n.dispatch("updateUnits").then(n.dispatch("updateCategories")).then(n.dispatch("updateEquipment"))}})}},de={components:{iconSpinner:N},name:"Login",data:function(){return{valuesEntered:!1,authPending:!1,username:"",password:"",farmosUrl:""}},methods:{checkValues:function(){var t=""!==this.username,e=""!==this.username,n=""!==this.password;t&&e&&n&&(this.valuesEntered=!0)},submitCredentials:function(){var t=this,e={farmosUrl:this.farmosUrl,username:this.username,password:this.password,router:this.$router};this.authPending=!0,this.$store.dispatch("didSubmitCredentials",e).then(function(){t.authPending=!1,t.$store.commit("setLoginStatus",!0),t.$store.dispatch("updateUserAndSiteInfo")})},onDeviceReady:function(){this.loadUserInfo()},loadUserInfo:function(){this.farmosUrl=window.localStorage.getItem("host").replace(/(^\w+:|^)\/\//,""),this.username=window.localStorage.getItem("username"),this.password=window.localStorage.getItem("password"),this.checkValues()}},created:function(){document.addEventListener("deviceready",this.onDeviceReady(),!1),this.loadUserInfo()}},me=(n("OITN"),Object(l.a)(de,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"login"}},[n("div",{staticClass:"input-group"},[t._m(0),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.farmosUrl,expression:"farmosUrl"}],staticClass:"form-control",attrs:{placeholder:"Enter your farmOS URL",autofocus:"",type:"url",autocomplete:"url"},domProps:{value:t.farmosUrl},on:{input:[function(e){e.target.composing||(t.farmosUrl=e.target.value)},t.checkValues]}})]),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"form-control",attrs:{placeholder:"Enter your username",type:"text",autocomplete:"username"},domProps:{value:t.username},on:{input:[function(e){e.target.composing||(t.username=e.target.value)},t.checkValues]}})]),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{placeholder:"Enter your password",type:"password",autocomplete:"current-password"},domProps:{value:t.password},on:{input:[function(e){e.target.composing||(t.password=e.target.value)},t.checkValues]}})]),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"input-group login-submit"},[t.authPending?n("div",[n("icon-spinner")],1):n("button",{staticClass:"btn btn-success btn-navbar",attrs:{disabled:!this.valuesEntered,title:"Submit credentials",type:"button"},on:{click:t.submitCredentials}},[t._v("\n      Submit credentials\n    ")])]),t._v(" "),n("br"),t._v(" "),t._m(1)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text"},[this._v("https://")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Need a server? Check out "),e("a",{attrs:{href:"https://farmos.org/hosting/"}},[this._v("hosting options")]),this._v(".")])}],!1,null,"00657035",null).exports),he={name:"Logout",methods:{goBack:function(){this.$router.back()},logout:function(){this.$store.dispatch("logout"),this.$store.commit("clearLogs"),this.$store.commit("clearAssets"),this.$store.commit("clearAreas"),this.$store.commit("changeUsername",""),this.$store.commit("changeEmail",""),this.$store.commit("changeUid",""),this.$store.commit("changeFarmName",""),this.$store.commit("changeFarmUrl",""),this.$store.dispatch("deleteAllCachedLogs"),this.$store.dispatch("deleteAllCachedAssets"),this.$store.dispatch("deleteAllCachedAreas"),this.$store.dispatch("deleteAllCachedUnits"),this.$store.dispatch("deleteAllCachedEquipment"),this.$store.dispatch("deleteAllCachedCategories"),this.$store.dispatch("deleteCachedUserAndSiteInfo"),this.$store.commit("setLoginStatus",!1),this.$router.push({path:"/login"})}}},ge=(n("+Ajr"),Object(l.a)(he,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container-fluid"},[this._m(0),this._v(" "),e("div",{staticClass:"row justify-content-sm-center"},[e("div",{staticClass:"col col-sm-auto",attrs:{id:"go-back"}},[e("button",{staticClass:"btn btn-lg btn-success",attrs:{type:"button",name:"button"},on:{click:this.goBack}},[this._v("\n        Go Back\n      ")])]),this._v(" "),e("div",{staticClass:"col col-sm-auto"},[e("button",{staticClass:"btn btn-lg btn-primary",attrs:{type:"button",name:"button"},on:{click:this.logout}},[this._v("\n        Logout\n      ")])])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"row",attrs:{id:"first-row"}},[e("div",{staticClass:"col"},[e("div",{staticClass:"card text-primary border-primary mb-3"},[e("div",{staticClass:"card-body"},[e("h4",{staticClass:"card-title"},[this._v("WARNING!")]),this._v(" "),e("p",{staticClass:"card-text"},[this._v("\n            Logging out will permanently delete all logs stored on this device.\n            You will not be able to recover logs which have not been synced with\n            your farmOS server. Go back to sync any unsaved logs, or proceed to\n            logout and clear all data from this device.\n          ")])])])])])}],!1,null,"f0c44152",null).exports),pe=function(){var t=localStorage.getItem("host"),e=localStorage.getItem("username"),n=localStorage.getItem("password");return ne()(t,e,n)},fe={actions:{didSubmitCredentials:function(t,e){var n=t.commit,a="https://"+e.farmosUrl,r=e.username,s=e.password,i=e.router,c=window.localStorage;return new o.a(function(t){ne()(a,r,s).authenticate().then(function(e){if(c.setItem("host",a),c.setItem("username",r),c.setItem("password",s),c.setItem("token",e),window.history.length>1)return window.history.back(),void t();i.push("/"),t()}).catch(function(){var o="http://"+e.farmosUrl;ne()(o,r,s).authenticate().then(function(e){if(c.setItem("host",o),c.setItem("username",r),c.setItem("password",s),c.setItem("token",e),window.history.length>1)return window.history.back(),void t();i.push("/"),t()}).catch(function(e){!function(t){if(403===t.status){var e={message:'The username or password you entered was incorrect. Please try again, or <a href="'+a+'/user/password">reset your password</a>.',errorCode:t.statusText,level:"warning",show:!0};n("logError",e)}else{var o={message:"Unable to reach the server. Please check that you have the correct URL and that your device has a network connection. Status: "+t.message,errorCode:t.statusText,level:"warning",show:!0};n("logError",o)}}(e),t()})})})},logout:function(){pe().logout().then(function(){})},updateUserAndSiteInfo:function(t){var e=t.commit;localStorage.getItem("username")&&pe().info().then(function(t){var n,a;e("changeFarmName",t.name),e("changeFarmUrl",t.url),e("changeUsername",t.user.name),e("changeEmail",t.user.mail),e("changeUid",t.user.uid),e("changeMapboxAPIKey",t.mapbox_api_key),e("setLoginStatus",!0),localStorage.setItem("farmName",t.name),localStorage.setItem("username",t.user.name),localStorage.setItem("email",t.user.mail),localStorage.setItem("uid",t.user.uid),n="mapboxAPIKey",a=t.mapbox_api_key,n?localStorage.setItem(n,a):localStorage.removeItem(n),localStorage.setItem("isLoggedIn",!0)})},loadCachedUserAndSiteInfo:function(t){var e=t.commit;e("changeUsername",localStorage.getItem("username")),e("changeEmail",localStorage.getItem("email")),e("changeUid",localStorage.getItem("uid")),e("changeMapboxAPIKey",localStorage.getItem("mapboxAPIKey")),e("setLoginStatus",localStorage.getItem("isLoggedIn")),e("changeFarmName",localStorage.getItem("farmName")),e("changeFarmUrl",localStorage.getItem("host")),localStorage.getItem("useGeolocation")&&("true"===localStorage.getItem("useGeolocation")?e("setUseGeolocation",!0):e("setUseGeolocation",!1))},deleteCachedUserAndSiteInfo:function(){localStorage.clear()}}};ce="#app",void 0!==(le=[Dt,Yt,ue,{install:function(t,e){var n=e.router,a=e.store,o=t.component(me.name,me),r=t.component(ge.name,ge);n.addRoutes([{path:"/login",name:"Login",component:o},{path:"/logout",name:"Logout",component:r}]),n.beforeEach(function(t,e,n){"/login"===e.path&&"/logout"===t.path&&n("/"),n()}),a.registerModule("auth",fe)}}])&&le.length>0&&le.forEach(function(t){return r.a.use(t,{store:xt,router:ot})}),Et().then(function(t){return t.client.modules.forEach(function(t){var e=document.createElement("script");e.src=t.index,e.id="field-module-"+t.name,e.type="module",e.async=!0,e.onload=function(){return r.a.use({install:window["install"+t.name]},{store:xt,router:ot})},e.onerror=function(){return console.error("Error installing "+t.name+" module")},document.body.appendChild(e)})}),new r.a({el:ce,store:xt,router:ot,components:{App:At},template:"<App/>"}),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js")})},hZfW:function(t,e,n){"use strict";var a=n("Knie");n.n(a).a},j3JQ:function(t,e,n){"use strict";var a=n("mt3h");n.n(a).a},kiQV:function(t){t.exports={a:"0.4.8"}},mRpm:function(t,e,n){"use strict";var a=n("JQmY");n.n(a).a},mt3h:function(t,e,n){},oGNR:function(t,e,n){},"qQ/H":function(t,e,n){},rTSf:function(t,e,n){"use strict";var a=n("9qtH");n.n(a).a}});
//# sourceMappingURL=app.88fddf8e3dbe570a0351.js.map